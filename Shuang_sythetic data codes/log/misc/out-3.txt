Start time is 2021-03-04 10:03:02.393348
dataset path is  data-2.npy
dataset size is 1000
----- start search_algorithm -----
----- start generate_rule_via_column_generation -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.9349 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 40 candidate rules.
[multiprocess log-grad] Elapsed: 1.6529 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 5.96985, std=1.98565, Rule = C --> F , C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 5.81681, std=1.93661, Rule = Not C --> F , Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 5.74685, std=1.93148, Rule = A --> F , A BEFORE F
-------------
log-likelihood-grad(all-data) mean= 5.35000, std=1.90792, Rule = D --> F , D BEFORE F
-------------
log-likelihood-grad(all-data) mean= 5.32362, std=1.94144, Rule = E --> F , E BEFORE F
-------------
log-likelihood-grad(all-data) mean= 5.29297, std=1.87762, Rule = Not A --> F , Not A BEFORE F
-------------
log-likelihood-grad(all-data) mean= 5.13158, std=1.97522, Rule = B --> F , B BEFORE F
-------------
log-likelihood-grad(all-data) mean= 5.12578, std=1.85312, Rule = Not E --> F , Not E BEFORE F
-------------
log-likelihood-grad(all-data) mean= 5.08686, std=1.88232, Rule = Not B --> F , Not B BEFORE F
-------------
log-likelihood-grad(all-data) mean= 5.05035, std=1.83850, Rule = Not D --> F , Not D BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.85782, std=0.76369, Rule = B --> F , B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.80417, std=0.72377, Rule = C --> F , C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.62225, std=0.74666, Rule = E --> F , E EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.60028, std=0.68458, Rule = Not C --> F , Not C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.59479, std=0.69364, Rule = Not A --> F , Not A EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.59185, std=0.72452, Rule = Not E --> F , Not E EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.58220, std=0.69140, Rule = D --> F , D EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.57884, std=0.73766, Rule = Not B --> F , Not B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.56183, std=0.70596, Rule = Not D --> F , Not D EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.54048, std=0.74543, Rule = A --> F , A EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.54048, std=0.74543, Rule = A --> Not F , A EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.56183, std=0.70596, Rule = Not D --> Not F , Not D EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.57884, std=0.73766, Rule = Not B --> Not F , Not B EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.58220, std=0.69140, Rule = D --> Not F , D EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.59185, std=0.72452, Rule = Not E --> Not F , Not E EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.59479, std=0.69364, Rule = Not A --> Not F , Not A EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.60028, std=0.68458, Rule = Not C --> Not F , Not C EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.62225, std=0.74666, Rule = E --> Not F , E EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.80417, std=0.72377, Rule = C --> Not F , C EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.85782, std=0.76369, Rule = B --> Not F , B EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -5.05035, std=1.83850, Rule = Not D --> Not F , Not D BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -5.08686, std=1.88232, Rule = Not B --> Not F , Not B BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -5.12578, std=1.85312, Rule = Not E --> Not F , Not E BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -5.13158, std=1.97522, Rule = B --> Not F , B BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -5.29297, std=1.87762, Rule = Not A --> Not F , Not A BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -5.32362, std=1.94144, Rule = E --> Not F , E BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -5.35000, std=1.90792, Rule = D --> Not F , D BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -5.74685, std=1.93148, Rule = A --> Not F , A BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -5.81681, std=1.93661, Rule = Not C --> Not F , Not C BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -5.96985, std=1.98565, Rule = C --> Not F , C BEFORE Not F
-------------
Best rule is: C --> F , C BEFORE F
Best log-likelihood-grad(all-data) = 5.969847710515083
new rule added.
Best rule is: Not C --> F , Not C BEFORE F
Best log-likelihood-grad(all-data) = 5.816808375143495
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = -0.2000
Rule0: C --> F , C BEFORE F, weight=0.0100
Rule1: Not C --> F , Not C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = -0.0608
Rule0: C --> F , C BEFORE F, weight=0.3241
Rule1: Not C --> F , Not C BEFORE F, weight=0.3242
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 33.3254 sec.
Update Log-likelihood (torch)=  -7.0242458854255885
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = -0.0608,
Rule0: C --> F , C BEFORE F, weight(torch)=0.3241.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.3242.
----- exit select_and_add_new_rule -----
----- exit generate_rule_via_column_generation -----
----- start generate_rule_via_column_generation -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 5.6769 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 38 candidate rules.
[multiprocess log-grad] Elapsed: 1.6206 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 3.31477, std=1.68818, Rule = A --> F , A BEFORE F
-------------
log-likelihood-grad(all-data) mean= 2.96510, std=1.61853, Rule = Not A --> F , Not A BEFORE F
-------------
log-likelihood-grad(all-data) mean= 2.85568, std=1.70651, Rule = D --> F , D BEFORE F
-------------
log-likelihood-grad(all-data) mean= 2.80777, std=1.76019, Rule = E --> F , E BEFORE F
-------------
log-likelihood-grad(all-data) mean= 2.72779, std=1.64878, Rule = Not E --> F , Not E BEFORE F
-------------
log-likelihood-grad(all-data) mean= 2.72051, std=1.69249, Rule = Not B --> F , Not B BEFORE F
-------------
log-likelihood-grad(all-data) mean= 2.67119, std=1.61892, Rule = Not D --> F , Not D BEFORE F
-------------
log-likelihood-grad(all-data) mean= 2.65517, std=1.82304, Rule = B --> F , B BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.58236, std=0.74760, Rule = B --> F , B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.52962, std=0.70730, Rule = C --> F , C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.33458, std=0.74471, Rule = E --> F , E EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.32276, std=0.67014, Rule = Not C --> F , Not C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.32140, std=0.68265, Rule = Not A --> F , Not A EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.31245, std=0.72570, Rule = Not E --> F , Not E EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.30378, std=0.73035, Rule = Not B --> F , Not B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.29758, std=0.69552, Rule = D --> F , D EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.28568, std=0.70786, Rule = Not D --> F , Not D EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.25242, std=0.74724, Rule = A --> F , A EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.25242, std=0.74724, Rule = A --> Not F , A EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.28568, std=0.70786, Rule = Not D --> Not F , Not D EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.29758, std=0.69552, Rule = D --> Not F , D EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.30378, std=0.73035, Rule = Not B --> Not F , Not B EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.31245, std=0.72570, Rule = Not E --> Not F , Not E EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.32140, std=0.68265, Rule = Not A --> Not F , Not A EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.32276, std=0.67014, Rule = Not C --> Not F , Not C EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.33458, std=0.74471, Rule = E --> Not F , E EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.52962, std=0.70730, Rule = C --> Not F , C EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -0.58236, std=0.74760, Rule = B --> Not F , B EQUAL Not F
-------------
log-likelihood-grad(all-data) mean= -2.65517, std=1.82304, Rule = B --> Not F , B BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -2.67119, std=1.61892, Rule = Not D --> Not F , Not D BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -2.72051, std=1.69249, Rule = Not B --> Not F , Not B BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -2.72779, std=1.64878, Rule = Not E --> Not F , Not E BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -2.80777, std=1.76019, Rule = E --> Not F , E BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -2.84701, std=1.29174, Rule = Not C --> Not F , Not C BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -2.85568, std=1.70651, Rule = D --> Not F , D BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -2.86754, std=1.39914, Rule = C --> Not F , C BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -2.96510, std=1.61853, Rule = Not A --> Not F , Not A BEFORE Not F
-------------
log-likelihood-grad(all-data) mean= -3.31477, std=1.68818, Rule = A --> Not F , A BEFORE Not F
-------------
Best rule is: A --> F , A BEFORE F
Best log-likelihood-grad(all-data) = 3.314773722046698
new rule added.
Best rule is: Not A --> F , Not A BEFORE F
Best log-likelihood-grad(all-data) = 2.9651026779986025
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = -0.0608
Rule0: C --> F , C BEFORE F, weight=0.3241
Rule1: Not C --> F , Not C BEFORE F, weight=0.3242
Rule2: A --> F , A BEFORE F, weight=0.0100
Rule3: Not A --> F , Not A BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1300
Rule0: C --> F , C BEFORE F, weight=0.4909
Rule1: Not C --> F , Not C BEFORE F, weight=0.5263
Rule2: A --> F , A BEFORE F, weight=0.1960
Rule3: Not A --> F , Not A BEFORE F, weight=0.1642
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 53.6160 sec.
Update Log-likelihood (torch)=  -5.58012276057538
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1300,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4909.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.5263.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1960.
Rule3: Not A --> F , Not A BEFORE F, weight(torch)=0.1642.
----- exit select_and_add_new_rule -----
----- exit generate_rule_via_column_generation -----
----- start generate_rule_via_column_generation -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 8.9791 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 16 candidate rules.
[multiprocess log-grad] Elapsed: 43.3022 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.29366, std=0.76458, Rule = B --> F , B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.23557, std=2.27859, Rule = Not B --> F , Not B BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.23058, std=0.73004, Rule = C --> F , C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.20544, std=2.24563, Rule = Not E --> F , Not E BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.18840, std=2.32620, Rule = D --> F , D BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.16712, std=2.23254, Rule = Not D --> F , Not D BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.11852, std=2.38538, Rule = E --> F , E BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03152, std=0.71253, Rule = Not C --> F , Not C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02402, std=2.46394, Rule = B --> F , B BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02163, std=0.71583, Rule = Not A --> F , Not A EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01116, std=0.79792, Rule = E --> F , E EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00493, std=0.77273, Rule = Not B --> F , Not B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00291, std=0.78181, Rule = Not E --> F , Not E EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01426, std=0.75902, Rule = Not D --> F , Not D EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02168, std=0.75317, Rule = D --> F , D EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.07177, std=0.79918, Rule = A --> F , A EQUAL F
-------------
Best rule is: B --> F , B EQUAL F
Best log-likelihood-grad(all-data) = 0.2936558538841105
new rule added.
Best rule is: Not B --> F , Not B BEFORE F
Best log-likelihood-grad(all-data) = 0.2355714237298585
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1300
Rule0: C --> F , C BEFORE F, weight=0.4909
Rule1: Not C --> F , Not C BEFORE F, weight=0.5263
Rule2: A --> F , A BEFORE F, weight=0.1960
Rule3: Not A --> F , Not A BEFORE F, weight=0.1642
Rule4: B --> F , B EQUAL F, weight=0.0100
Rule5: Not B --> F , Not B BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1380
Rule0: C --> F , C BEFORE F, weight=0.4743
Rule1: Not C --> F , Not C BEFORE F, weight=0.6056
Rule2: A --> F , A BEFORE F, weight=0.2594
Rule3: Not A --> F , Not A BEFORE F, weight=0.0957
Rule4: B --> F , B EQUAL F, weight=0.3063
Rule5: Not B --> F , Not B BEFORE F, weight=-0.0125
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 1.2238 min.
Update Log-likelihood (torch)=  -5.546246286781693
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1380,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4743.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.6056.
Rule2: A --> F , A BEFORE F, weight(torch)=0.2594.
Rule3: Not A --> F , Not A BEFORE F, weight(torch)=0.0957.
Rule4: B --> F , B EQUAL F, weight(torch)=0.3063.
Rule5: Not B --> F , Not B BEFORE F, weight(torch)=-0.0125.
delete these rules: [5]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1380
Rule0: C --> F , C BEFORE F, weight=0.4743
Rule1: Not C --> F , Not C BEFORE F, weight=0.6056
Rule2: A --> F , A BEFORE F, weight=0.2594
Rule3: Not A --> F , Not A BEFORE F, weight=0.0957
Rule4: B --> F , B EQUAL F, weight=0.3063
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1260
Rule0: C --> F , C BEFORE F, weight=0.4258
Rule1: Not C --> F , Not C BEFORE F, weight=0.6395
Rule2: A --> F , A BEFORE F, weight=0.2850
Rule3: Not A --> F , Not A BEFORE F, weight=0.0417
Rule4: B --> F , B EQUAL F, weight=0.3801
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 1.0583 min.
update Log-likelihood (torch)=  -5.531498667172113
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1260,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4258.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.6395.
Rule2: A --> F , A BEFORE F, weight(torch)=0.2850.
Rule3: Not A --> F , Not A BEFORE F, weight(torch)=0.0417.
Rule4: B --> F , B EQUAL F, weight(torch)=0.3801.
----- exit select_and_add_new_rule -----
----- exit generate_rule_via_column_generation -----
----- start generate_rule_via_column_generation -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 10.9022 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 14 candidate rules.
[multiprocess log-grad] Elapsed: 41.8484 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.18344, std=0.73676, Rule = C --> F , C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02032, std=0.71047, Rule = Not C --> F , Not C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00618, std=2.31570, Rule = Not E --> F , Not E BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02027, std=0.80210, Rule = E --> F , E EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02282, std=0.72161, Rule = Not A --> F , Not A EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02665, std=0.78433, Rule = Not E --> F , Not E EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.03859, std=2.29506, Rule = Not D --> F , Not D BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04142, std=0.76809, Rule = Not D --> F , Not D EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.04304, std=2.39063, Rule = D --> F , D BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04420, std=0.78252, Rule = Not B --> F , Not B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.05251, std=0.76274, Rule = D --> F , D EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.08187, std=0.80000, Rule = A --> F , A EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.11768, std=2.45537, Rule = E --> F , E BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.16705, std=2.52443, Rule = B --> F , B BEFORE F
-------------
Best rule is: C --> F , C EQUAL F
Best log-likelihood-grad(all-data) = 0.1834426234819299
new rule added.
Best rule is: Not C --> F , Not C EQUAL F
Best log-likelihood-grad(all-data) = 0.02032214994113123
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1260
Rule0: C --> F , C BEFORE F, weight=0.4258
Rule1: Not C --> F , Not C BEFORE F, weight=0.6395
Rule2: A --> F , A BEFORE F, weight=0.2850
Rule3: Not A --> F , Not A BEFORE F, weight=0.0417
Rule4: B --> F , B EQUAL F, weight=0.3801
Rule5: C --> F , C EQUAL F, weight=0.0100
Rule6: Not C --> F , Not C EQUAL F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1164
Rule0: C --> F , C BEFORE F, weight=0.3832
Rule1: Not C --> F , Not C BEFORE F, weight=0.6578
Rule2: A --> F , A BEFORE F, weight=0.3134
Rule3: Not A --> F , Not A BEFORE F, weight=0.0237
Rule4: B --> F , B EQUAL F, weight=0.4155
Rule5: C --> F , C EQUAL F, weight=0.2043
Rule6: Not C --> F , Not C EQUAL F, weight=0.0025
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 1.3955 min.
Update Log-likelihood (torch)=  -5.495270583122386
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1164,
Rule0: C --> F , C BEFORE F, weight(torch)=0.3832.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.6578.
Rule2: A --> F , A BEFORE F, weight(torch)=0.3134.
Rule3: Not A --> F , Not A BEFORE F, weight(torch)=0.0237.
Rule4: B --> F , B EQUAL F, weight(torch)=0.4155.
Rule5: C --> F , C EQUAL F, weight(torch)=0.2043.
Rule6: Not C --> F , Not C EQUAL F, weight(torch)=0.0025.
delete these rules: [6]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1164
Rule0: C --> F , C BEFORE F, weight=0.3832
Rule1: Not C --> F , Not C BEFORE F, weight=0.6578
Rule2: A --> F , A BEFORE F, weight=0.3134
Rule3: Not A --> F , Not A BEFORE F, weight=0.0237
Rule4: B --> F , B EQUAL F, weight=0.4155
Rule5: C --> F , C EQUAL F, weight=0.2043
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1268
Rule0: C --> F , C BEFORE F, weight=0.3862
Rule1: Not C --> F , Not C BEFORE F, weight=0.6694
Rule2: A --> F , A BEFORE F, weight=0.3267
Rule3: Not A --> F , Not A BEFORE F, weight=0.0154
Rule4: B --> F , B EQUAL F, weight=0.3624
Rule5: C --> F , C EQUAL F, weight=0.2483
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 1.2376 min.
update Log-likelihood (torch)=  -5.489160708964549
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1268,
Rule0: C --> F , C BEFORE F, weight(torch)=0.3862.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.6694.
Rule2: A --> F , A BEFORE F, weight(torch)=0.3267.
Rule3: Not A --> F , Not A BEFORE F, weight(torch)=0.0154.
Rule4: B --> F , B EQUAL F, weight(torch)=0.3624.
Rule5: C --> F , C EQUAL F, weight(torch)=0.2483.
----- exit select_and_add_new_rule -----
----- exit generate_rule_via_column_generation -----
----- start generate_rule_via_column_generation -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 12.4072 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 7 workers, process 7 candidate rules.
[multiprocess log-grad] Elapsed: 22.2689 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= -0.04115, std=0.80522, Rule = E --> F , E EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.04662, std=0.72558, Rule = Not A --> F , Not A EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.14252, std=2.35907, Rule = Not E --> F , Not E BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.17303, std=2.33901, Rule = Not D --> F , Not D BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.19175, std=2.43510, Rule = D --> F , D BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.26827, std=2.50122, Rule = E --> F , E BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.31305, std=2.56892, Rule = B --> F , B BEFORE F
-------------
best gain -0.04115271812674036 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit generate_rule_via_column_generation -----
start to extend this rule: Not C --> F , Not C BEFORE F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 12.1755 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 32 candidate rules.
[multiprocess log-grad] Elapsed: 1.7132 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.30685, std=1.65801, Rule = A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.21843, std=1.68426, Rule = Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.11055, std=0.61442, Rule = B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.10108, std=1.99061, Rule = Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.09867, std=0.89273, Rule = A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.09845, std=0.86085, Rule = Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.08865, std=1.92756, Rule = D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.07359, std=1.87587, Rule = Not D ^ Not C --> F , Not D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.07190, std=2.02899, Rule = E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.05982, std=2.04411, Rule = Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03538, std=0.43263, Rule = Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03398, std=1.03824, Rule = D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02751, std=0.44715, Rule = A ^ Not C --> F , A EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02594, std=0.98706, Rule = Not D ^ Not C --> F , Not D BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02448, std=0.43310, Rule = Not A ^ Not C --> F , Not A EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02400, std=1.02049, Rule = Not B ^ Not C --> F , Not B BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02317, std=1.04076, Rule = Not E ^ Not C --> F , Not E BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02212, std=0.61502, Rule = E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01707, std=0.48049, Rule = Not E ^ Not C --> F , Not E EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01514, std=0.58473, Rule = Not A ^ Not C --> F , Not A EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01318, std=1.09427, Rule = B ^ Not C --> F , B BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01274, std=1.11897, Rule = E ^ Not C --> F , E BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00696, std=0.46097, Rule = D ^ Not C --> F , D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00077, std=0.49205, Rule = E ^ Not C --> F , E EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00994, std=0.49026, Rule = Not B ^ Not C --> F , Not B EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00997, std=0.59105, Rule = D ^ Not C --> F , D EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01451, std=0.49585, Rule = B ^ Not C --> F , B EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02242, std=0.64437, Rule = Not D ^ Not C --> F , Not D EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02331, std=0.63746, Rule = Not E ^ Not C --> F , Not E EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02728, std=0.62612, Rule = Not B ^ Not C --> F , Not B EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02854, std=0.61215, Rule = A ^ Not C --> F , A EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03261, std=2.09921, Rule = B ^ Not C --> F , B BEFORE F ^ Not C BEFORE F
-------------
Best rule is: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.30685313847854623
new rule added.
Best rule is: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.21842974180647862
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1268
Rule0: C --> F , C BEFORE F, weight=0.3862
Rule1: Not C --> F , Not C BEFORE F, weight=0.6694
Rule2: A --> F , A BEFORE F, weight=0.3267
Rule3: Not A --> F , Not A BEFORE F, weight=0.0154
Rule4: B --> F , B EQUAL F, weight=0.3624
Rule5: C --> F , C EQUAL F, weight=0.2483
Rule6: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.0100
Rule7: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1225
Rule0: C --> F , C BEFORE F, weight=0.3731
Rule1: Not C --> F , Not C BEFORE F, weight=0.5581
Rule2: A --> F , A BEFORE F, weight=0.2493
Rule3: Not A --> F , Not A BEFORE F, weight=-0.0283
Rule4: B --> F , B EQUAL F, weight=0.3971
Rule5: C --> F , C EQUAL F, weight=0.2285
Rule6: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1836
Rule7: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.1196
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 1.7480 min.
Update Log-likelihood (torch)=  -5.390239574877382
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1225,
Rule0: C --> F , C BEFORE F, weight(torch)=0.3731.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.5581.
Rule2: A --> F , A BEFORE F, weight(torch)=0.2493.
Rule3: Not A --> F , Not A BEFORE F, weight(torch)=-0.0283.
Rule4: B --> F , B EQUAL F, weight(torch)=0.3971.
Rule5: C --> F , C EQUAL F, weight(torch)=0.2285.
Rule6: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1836.
Rule7: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1196.
delete these rules: [3]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1225
Rule0: C --> F , C BEFORE F, weight=0.3731
Rule1: Not C --> F , Not C BEFORE F, weight=0.5581
Rule2: A --> F , A BEFORE F, weight=0.2493
Rule3: B --> F , B EQUAL F, weight=0.3971
Rule4: C --> F , C EQUAL F, weight=0.2285
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1836
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.1196
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1284
Rule0: C --> F , C BEFORE F, weight=0.3804
Rule1: Not C --> F , Not C BEFORE F, weight=0.4701
Rule2: A --> F , A BEFORE F, weight=0.1891
Rule3: B --> F , B EQUAL F, weight=0.4104
Rule4: C --> F , C EQUAL F, weight=0.2463
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3075
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.1149
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 1.5742 min.
update Log-likelihood (torch)=  -5.413187538312853
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1284,
Rule0: C --> F , C BEFORE F, weight(torch)=0.3804.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4701.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1891.
Rule3: B --> F , B EQUAL F, weight(torch)=0.4104.
Rule4: C --> F , C EQUAL F, weight(torch)=0.2463.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.3075.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1149.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 15.7752 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 30 candidate rules.
[multiprocess log-grad] Elapsed: 1.6946 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.11018, std=1.96809, Rule = Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.10591, std=0.61114, Rule = B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.09801, std=1.94498, Rule = D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.09214, std=2.00126, Rule = E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.07328, std=1.89084, Rule = Not D ^ Not C --> F , Not D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.06323, std=2.03663, Rule = Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03570, std=0.42745, Rule = Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02108, std=0.62775, Rule = E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01731, std=0.46622, Rule = Not E ^ Not C --> F , Not E EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01489, std=1.05525, Rule = D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01448, std=0.58906, Rule = Not A ^ Not C --> F , Not A EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01236, std=0.98988, Rule = A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01144, std=0.45534, Rule = D ^ Not C --> F , D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01138, std=0.95364, Rule = Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00390, std=1.04545, Rule = Not E ^ Not C --> F , Not E BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00342, std=0.48190, Rule = E ^ Not C --> F , E EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00278, std=0.99987, Rule = Not D ^ Not C --> F , Not D BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00197, std=1.03822, Rule = Not B ^ Not C --> F , Not B BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00001, std=1.11341, Rule = E ^ Not C --> F , E BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00103, std=1.10932, Rule = B ^ Not C --> F , B BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00213, std=0.58373, Rule = D ^ Not C --> F , D EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00673, std=0.48419, Rule = A ^ Not C --> F , A EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00857, std=0.47525, Rule = Not A ^ Not C --> F , Not A EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01129, std=0.48797, Rule = Not B ^ Not C --> F , Not B EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01388, std=0.49541, Rule = B ^ Not C --> F , B EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01535, std=2.09495, Rule = B ^ Not C --> F , B BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02100, std=0.65747, Rule = Not D ^ Not C --> F , Not D EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02270, std=0.61895, Rule = A ^ Not C --> F , A EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02331, std=0.64492, Rule = Not E ^ Not C --> F , Not E EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02629, std=0.63951, Rule = Not B ^ Not C --> F , Not B EQUAL F ^ Not C BEFORE F
-------------
Best rule is: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.11018080484710469
new rule added.
Best rule is: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.10590518566182454
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1284
Rule0: C --> F , C BEFORE F, weight=0.3804
Rule1: Not C --> F , Not C BEFORE F, weight=0.4701
Rule2: A --> F , A BEFORE F, weight=0.1891
Rule3: B --> F , B EQUAL F, weight=0.4104
Rule4: C --> F , C EQUAL F, weight=0.2463
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3075
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.1149
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0100
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1267
Rule0: C --> F , C BEFORE F, weight=0.4157
Rule1: Not C --> F , Not C BEFORE F, weight=0.3734
Rule2: A --> F , A BEFORE F, weight=0.1623
Rule3: B --> F , B EQUAL F, weight=0.3626
Rule4: C --> F , C EQUAL F, weight=0.2686
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3624
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0994
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0475
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.1830
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 2.0442 min.
Update Log-likelihood (torch)=  -5.451214608285555
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1267,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4157.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.3734.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1623.
Rule3: B --> F , B EQUAL F, weight(torch)=0.3626.
Rule4: C --> F , C EQUAL F, weight(torch)=0.2686.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.3624.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0994.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0475.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.1830.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 19.6966 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 19 candidate rules.
[multiprocess log-grad] Elapsed: 1.2435 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.11044, std=1.94317, Rule = D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.08601, std=1.88904, Rule = Not D ^ Not C --> F , Not D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.07142, std=2.04330, Rule = E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.06556, std=2.05568, Rule = Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03723, std=0.42604, Rule = Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02215, std=1.05387, Rule = D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02116, std=0.62843, Rule = E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01502, std=0.99298, Rule = A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01466, std=0.58813, Rule = Not A ^ Not C --> F , Not A EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01433, std=0.95871, Rule = Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01342, std=0.45439, Rule = D ^ Not C --> F , D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01047, std=0.48194, Rule = Not E ^ Not C --> F , Not E EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00899, std=0.99885, Rule = Not D ^ Not C --> F , Not D BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00505, std=1.04799, Rule = Not B ^ Not C --> F , Not B BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00494, std=1.11683, Rule = B ^ Not C --> F , B BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00648, std=0.47711, Rule = Not A ^ Not C --> F , Not A EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00681, std=1.07335, Rule = Not E ^ Not C --> F , Not E BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00725, std=0.48735, Rule = A ^ Not C --> F , A EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00795, std=1.14178, Rule = E ^ Not C --> F , E BEFORE Not C ^ Not C BEFORE F
-------------
Best rule is: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.11044240335881077
new rule added.
Best rule is: Not D ^ Not C --> F , Not D BEFORE F ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.08601094247016351
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1267
Rule0: C --> F , C BEFORE F, weight=0.4157
Rule1: Not C --> F , Not C BEFORE F, weight=0.3734
Rule2: A --> F , A BEFORE F, weight=0.1623
Rule3: B --> F , B EQUAL F, weight=0.3626
Rule4: C --> F , C EQUAL F, weight=0.2686
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3624
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0994
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0475
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.1830
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0100
Rule10: Not D ^ Not C --> F , Not D BEFORE F ^ Not C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1239
Rule0: C --> F , C BEFORE F, weight=0.4577
Rule1: Not C --> F , Not C BEFORE F, weight=0.2817
Rule2: A --> F , A BEFORE F, weight=0.1461
Rule3: B --> F , B EQUAL F, weight=0.3391
Rule4: C --> F , C EQUAL F, weight=0.2987
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4070
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0921
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0706
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3166
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0184
Rule10: Not D ^ Not C --> F , Not D BEFORE F ^ Not C BEFORE F, weight=-0.0147
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 2.5486 min.
Update Log-likelihood (torch)=  -5.319753301190448
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1239,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4577.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.2817.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1461.
Rule3: B --> F , B EQUAL F, weight(torch)=0.3391.
Rule4: C --> F , C EQUAL F, weight(torch)=0.2987.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4070.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0921.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0706.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.3166.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0184.
Rule10: Not D ^ Not C --> F , Not D BEFORE F ^ Not C BEFORE F, weight(torch)=-0.0147.
delete these rules: [10]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1239
Rule0: C --> F , C BEFORE F, weight=0.4577
Rule1: Not C --> F , Not C BEFORE F, weight=0.2817
Rule2: A --> F , A BEFORE F, weight=0.1461
Rule3: B --> F , B EQUAL F, weight=0.3391
Rule4: C --> F , C EQUAL F, weight=0.2987
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4070
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0921
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0706
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3166
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0184
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1364
Rule0: C --> F , C BEFORE F, weight=0.4603
Rule1: Not C --> F , Not C BEFORE F, weight=0.2229
Rule2: A --> F , A BEFORE F, weight=0.1406
Rule3: B --> F , B EQUAL F, weight=0.2617
Rule4: C --> F , C EQUAL F, weight=0.2994
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4227
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0973
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0469
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3712
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0188
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 2.3540 min.
update Log-likelihood (torch)=  -5.3683515371514
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1364,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4603.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.2229.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1406.
Rule3: B --> F , B EQUAL F, weight(torch)=0.2617.
Rule4: C --> F , C EQUAL F, weight(torch)=0.2994.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4227.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0973.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0469.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.3712.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0188.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 22.2453 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 10 candidate rules.
[multiprocess log-grad] Elapsed: 50.0692 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.27462, std=1.95295, Rule = E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.25350, std=1.99190, Rule = Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.11728, std=1.01990, Rule = D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.09767, std=0.96205, Rule = A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.09247, std=0.92670, Rule = Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.05774, std=0.41852, Rule = Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.04508, std=0.61980, Rule = E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03605, std=0.44434, Rule = D ^ Not C --> F , D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03567, std=0.46124, Rule = Not E ^ Not C --> F , Not E EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03377, std=0.57887, Rule = Not A ^ Not C --> F , Not A EQUAL F ^ Not C BEFORE F
-------------
Best rule is: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.274615304801664
new rule added.
Best rule is: Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.25350251959465586
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1364
Rule0: C --> F , C BEFORE F, weight=0.4603
Rule1: Not C --> F , Not C BEFORE F, weight=0.2229
Rule2: A --> F , A BEFORE F, weight=0.1406
Rule3: B --> F , B EQUAL F, weight=0.2617
Rule4: C --> F , C EQUAL F, weight=0.2994
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4227
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0973
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0469
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3712
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0188
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0100
Rule11: Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1219
Rule0: C --> F , C BEFORE F, weight=0.4658
Rule1: Not C --> F , Not C BEFORE F, weight=0.2182
Rule2: A --> F , A BEFORE F, weight=0.1566
Rule3: B --> F , B EQUAL F, weight=0.2094
Rule4: C --> F , C EQUAL F, weight=0.3037
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4592
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0850
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0651
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3935
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0248
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0225
Rule11: Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F, weight=0.0226
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 2.7902 min.
Update Log-likelihood (torch)=  -5.3360380893584605
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1219,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4658.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.2182.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1566.
Rule3: B --> F , B EQUAL F, weight(torch)=0.2094.
Rule4: C --> F , C EQUAL F, weight(torch)=0.3037.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4592.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0850.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0651.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.3935.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0248.
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0225.
Rule11: Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F, weight(torch)=0.0226.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 26.9356 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 8 candidate rules.
[multiprocess log-grad] Elapsed: 29.2679 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.02500, std=0.43381, Rule = Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01007, std=0.63877, Rule = E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00012, std=0.46570, Rule = D ^ Not C --> F , D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00109, std=0.59774, Rule = Not A ^ Not C --> F , Not A EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00629, std=0.50129, Rule = Not E ^ Not C --> F , Not E EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03551, std=1.09618, Rule = D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04666, std=1.02082, Rule = Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.05100, std=1.05565, Rule = A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F
-------------
Best rule is: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.024996394143381385
new rule added.
best gain 0.010068485794792689 does not meet thershold 0.02.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1219
Rule0: C --> F , C BEFORE F, weight=0.4658
Rule1: Not C --> F , Not C BEFORE F, weight=0.2182
Rule2: A --> F , A BEFORE F, weight=0.1566
Rule3: B --> F , B EQUAL F, weight=0.2094
Rule4: C --> F , C EQUAL F, weight=0.3037
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4592
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0850
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0651
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3935
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0248
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0225
Rule11: Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F, weight=0.0226
Rule12: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1333
Rule0: C --> F , C BEFORE F, weight=0.4987
Rule1: Not C --> F , Not C BEFORE F, weight=0.1918
Rule2: A --> F , A BEFORE F, weight=0.1343
Rule3: B --> F , B EQUAL F, weight=0.2089
Rule4: C --> F , C EQUAL F, weight=0.2931
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5069
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0464
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0698
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4391
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0195
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0245
Rule11: Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F, weight=0.0079
Rule12: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0625
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 3.0392 min.
Update Log-likelihood (torch)=  -5.293516402203708
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1333,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4987.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.1918.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1343.
Rule3: B --> F , B EQUAL F, weight(torch)=0.2089.
Rule4: C --> F , C EQUAL F, weight(torch)=0.2931.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.5069.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0464.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0698.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.4391.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0195.
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0245.
Rule11: Not B ^ Not C --> F , Not B BEFORE F ^ Not C BEFORE F, weight(torch)=0.0079.
Rule12: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0625.
delete these rules: [11]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1333
Rule0: C --> F , C BEFORE F, weight=0.4987
Rule1: Not C --> F , Not C BEFORE F, weight=0.1918
Rule2: A --> F , A BEFORE F, weight=0.1343
Rule3: B --> F , B EQUAL F, weight=0.2089
Rule4: C --> F , C EQUAL F, weight=0.2931
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5069
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0464
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0698
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4391
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0195
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0245
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0625
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1396
Rule0: C --> F , C BEFORE F, weight=0.4946
Rule1: Not C --> F , Not C BEFORE F, weight=0.1573
Rule2: A --> F , A BEFORE F, weight=0.1244
Rule3: B --> F , B EQUAL F, weight=0.1896
Rule4: C --> F , C EQUAL F, weight=0.2819
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5154
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0496
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0707
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4891
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0356
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0097
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0753
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 2.8066 min.
update Log-likelihood (torch)=  -5.33799319250609
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1396,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4946.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.1573.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1244.
Rule3: B --> F , B EQUAL F, weight(torch)=0.1896.
Rule4: C --> F , C EQUAL F, weight(torch)=0.2819.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.5154.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0496.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0707.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.4891.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0356.
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0097.
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0753.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 26.6428 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 6 workers, process 6 candidate rules.
[multiprocess log-grad] Elapsed: 27.9454 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.03864, std=1.06998, Rule = D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02835, std=0.63102, Rule = E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02762, std=0.98328, Rule = Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02404, std=1.02101, Rule = A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01342, std=0.48695, Rule = Not E ^ Not C --> F , Not E EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01323, std=0.59190, Rule = Not A ^ Not C --> F , Not A EQUAL F ^ Not C BEFORE F
-------------
Best rule is: D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.0386426015143787
new rule added.
Best rule is: E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.02835364947452754
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1396
Rule0: C --> F , C BEFORE F, weight=0.4946
Rule1: Not C --> F , Not C BEFORE F, weight=0.1573
Rule2: A --> F , A BEFORE F, weight=0.1244
Rule3: B --> F , B EQUAL F, weight=0.1896
Rule4: C --> F , C EQUAL F, weight=0.2819
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5154
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0496
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0707
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4891
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0356
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0097
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0753
Rule12: D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F, weight=0.0100
Rule13: E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1379
Rule0: C --> F , C BEFORE F, weight=0.5230
Rule1: Not C --> F , Not C BEFORE F, weight=0.1438
Rule2: A --> F , A BEFORE F, weight=0.1133
Rule3: B --> F , B EQUAL F, weight=0.1811
Rule4: C --> F , C EQUAL F, weight=0.3257
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5163
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0598
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0833
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5073
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0428
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0156
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1324
Rule12: D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F, weight=-0.0139
Rule13: E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F, weight=0.0053
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 3.3191 min.
Update Log-likelihood (torch)=  -5.293496342478173
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1379,
Rule0: C --> F , C BEFORE F, weight(torch)=0.5230.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.1438.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1133.
Rule3: B --> F , B EQUAL F, weight(torch)=0.1811.
Rule4: C --> F , C EQUAL F, weight(torch)=0.3257.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.5163.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0598.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0833.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.5073.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0428.
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0156.
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1324.
Rule12: D ^ Not C --> F , D BEFORE Not C ^ Not C BEFORE F, weight(torch)=-0.0139.
Rule13: E ^ Not C --> F , E EQUAL F ^ Not C BEFORE F, weight(torch)=0.0053.
delete these rules: [12, 13]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1379
Rule0: C --> F , C BEFORE F, weight=0.5230
Rule1: Not C --> F , Not C BEFORE F, weight=0.1438
Rule2: A --> F , A BEFORE F, weight=0.1133
Rule3: B --> F , B EQUAL F, weight=0.1811
Rule4: C --> F , C EQUAL F, weight=0.3257
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5163
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0598
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0833
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5073
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0428
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0156
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1324
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1271
Rule0: C --> F , C BEFORE F, weight=0.5132
Rule1: Not C --> F , Not C BEFORE F, weight=0.1204
Rule2: A --> F , A BEFORE F, weight=0.1229
Rule3: B --> F , B EQUAL F, weight=0.1754
Rule4: C --> F , C EQUAL F, weight=0.3118
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4984
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0392
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0688
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4790
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0337
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=-0.0041
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1157
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 2.7942 min.
update Log-likelihood (torch)=  -5.308164899911366
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1271,
Rule0: C --> F , C BEFORE F, weight(torch)=0.5132.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.1204.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1229.
Rule3: B --> F , B EQUAL F, weight(torch)=0.1754.
Rule4: C --> F , C EQUAL F, weight(torch)=0.3118.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4984.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0392.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0688.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.4790.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0337.
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight(torch)=-0.0041.
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1157.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 26.7092 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 4 workers, process 4 candidate rules.
[multiprocess log-grad] Elapsed: 23.5525 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.12148, std=0.94096, Rule = A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.11903, std=0.90415, Rule = Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03963, std=0.45594, Rule = Not E ^ Not C --> F , Not E EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03312, std=0.57743, Rule = Not A ^ Not C --> F , Not A EQUAL F ^ Not C BEFORE F
-------------
Best rule is: A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.12148438997636882
new rule added.
Best rule is: Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.1190261252402986
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1271
Rule0: C --> F , C BEFORE F, weight=0.5132
Rule1: Not C --> F , Not C BEFORE F, weight=0.1204
Rule2: A --> F , A BEFORE F, weight=0.1229
Rule3: B --> F , B EQUAL F, weight=0.1754
Rule4: C --> F , C EQUAL F, weight=0.3118
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4984
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0392
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0688
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4790
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0337
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=-0.0041
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1157
Rule12: A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F, weight=0.0100
Rule13: Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1378
Rule0: C --> F , C BEFORE F, weight=0.5350
Rule1: Not C --> F , Not C BEFORE F, weight=0.1111
Rule2: A --> F , A BEFORE F, weight=0.1374
Rule3: B --> F , B EQUAL F, weight=0.1555
Rule4: C --> F , C EQUAL F, weight=0.3332
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5211
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0472
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0835
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5146
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0640
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight=0.0087
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0838
Rule12: A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F, weight=0.0017
Rule13: Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F, weight=0.0007
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 3.2361 min.
Update Log-likelihood (torch)=  -5.2976629628524385
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1378,
Rule0: C --> F , C BEFORE F, weight(torch)=0.5350.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.1111.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1374.
Rule3: B --> F , B EQUAL F, weight(torch)=0.1555.
Rule4: C --> F , C EQUAL F, weight(torch)=0.3332.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.5211.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0472.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0835.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.5146.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0640.
Rule10: E ^ Not C --> F , E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0087.
Rule11: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0838.
Rule12: A ^ Not C --> F , A BEFORE Not C ^ Not C BEFORE F, weight(torch)=0.0017.
Rule13: Not A ^ Not C --> F , Not A BEFORE Not C ^ Not C BEFORE F, weight(torch)=0.0007.
delete these rules: [10, 12, 13]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1378
Rule0: C --> F , C BEFORE F, weight=0.5350
Rule1: Not C --> F , Not C BEFORE F, weight=0.1111
Rule2: A --> F , A BEFORE F, weight=0.1374
Rule3: B --> F , B EQUAL F, weight=0.1555
Rule4: C --> F , C EQUAL F, weight=0.3332
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5211
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0472
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0835
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5146
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0640
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0838
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1235
Rule0: C --> F , C BEFORE F, weight=0.5207
Rule1: Not C --> F , Not C BEFORE F, weight=0.0759
Rule2: A --> F , A BEFORE F, weight=0.1268
Rule3: B --> F , B EQUAL F, weight=0.1831
Rule4: C --> F , C EQUAL F, weight=0.3298
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5154
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0536
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0938
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5286
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0723
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1150
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 2.5683 min.
update Log-likelihood (torch)=  -5.330671943709982
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1235,
Rule0: C --> F , C BEFORE F, weight(torch)=0.5207.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.0759.
Rule2: A --> F , A BEFORE F, weight(torch)=0.1268.
Rule3: B --> F , B EQUAL F, weight(torch)=0.1831.
Rule4: C --> F , C EQUAL F, weight(torch)=0.3298.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.5154.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0536.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0938.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.5286.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0723.
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1150.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 24.3047 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 2 workers, process 2 candidate rules.
[multiprocess log-grad] Elapsed: 24.2763 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.01381, std=0.58701, Rule = Not A ^ Not C --> F , Not A EQUAL F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01233, std=0.48361, Rule = Not E ^ Not C --> F , Not E EQUAL Not C ^ Not C BEFORE F
-------------
best gain 0.013812254734823885 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: C --> F , C BEFORE F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 24.4954 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 32 candidate rules.
[multiprocess log-grad] Elapsed: 1.7682 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.30534, std=1.88214, Rule = A ^ C --> F , A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.22954, std=1.81762, Rule = Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.17736, std=1.97794, Rule = Not B ^ C --> F , Not B BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.14629, std=2.00178, Rule = Not E ^ C --> F , Not E BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.13289, std=1.96757, Rule = Not D ^ C --> F , Not D BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.13200, std=2.06333, Rule = D ^ C --> F , D BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.13149, std=0.98747, Rule = A ^ C --> F , A BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.12794, std=2.05660, Rule = E ^ C --> F , E BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.12636, std=0.91788, Rule = Not A ^ C --> F , Not A BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.09750, std=2.05058, Rule = B ^ C --> F , B BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.08444, std=1.04198, Rule = D ^ C --> F , D BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.07864, std=0.98140, Rule = Not D ^ C --> F , Not D BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.07005, std=1.00818, Rule = Not E ^ C --> F , Not E BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.06723, std=1.05006, Rule = B ^ C --> F , B BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.06204, std=0.77861, Rule = B ^ C --> F , B EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.06194, std=0.43883, Rule = A ^ C --> F , A EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.06034, std=1.02644, Rule = Not B ^ C --> F , Not B BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.04961, std=0.41152, Rule = Not A ^ C --> F , Not A EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.04882, std=1.06633, Rule = E ^ C --> F , E BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.04149, std=0.66535, Rule = E ^ C --> F , E EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02785, std=0.47894, Rule = Not B ^ C --> F , Not B EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02574, std=0.50737, Rule = E ^ C --> F , E EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02117, std=0.61709, Rule = Not A ^ C --> F , Not A EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01753, std=0.47806, Rule = B ^ C --> F , B EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01606, std=0.48455, Rule = Not D ^ C --> F , Not D EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01335, std=0.51547, Rule = D ^ C --> F , D EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01202, std=0.63532, Rule = Not E ^ C --> F , Not E EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00579, std=0.47527, Rule = Not E ^ C --> F , Not E EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00508, std=0.59097, Rule = D ^ C --> F , D EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00581, std=0.65291, Rule = A ^ C --> F , A EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01751, std=0.67519, Rule = Not D ^ C --> F , Not D EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02042, std=0.66047, Rule = Not B ^ C --> F , Not B EQUAL F ^ C BEFORE F
-------------
Best rule is: A ^ C --> F , A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.3053360662361579
new rule added.
Best rule is: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.22953644152346647
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1235
Rule0: C --> F , C BEFORE F, weight=0.5207
Rule1: Not C --> F , Not C BEFORE F, weight=0.0759
Rule2: A --> F , A BEFORE F, weight=0.1268
Rule3: B --> F , B EQUAL F, weight=0.1831
Rule4: C --> F , C EQUAL F, weight=0.3298
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.5154
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0536
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0938
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5286
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0723
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1150
Rule11: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.0100
Rule12: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1272
Rule0: C --> F , C BEFORE F, weight=0.4938
Rule1: Not C --> F , Not C BEFORE F, weight=0.0646
Rule2: A --> F , A BEFORE F, weight=0.0860
Rule3: B --> F , B EQUAL F, weight=0.1464
Rule4: C --> F , C EQUAL F, weight=0.3295
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4964
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0124
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0949
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5344
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0654
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1139
Rule11: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.1534
Rule12: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0719
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 3.0267 min.
Update Log-likelihood (torch)=  -5.303587154028988
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1272,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4938.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.0646.
Rule2: A --> F , A BEFORE F, weight(torch)=0.0860.
Rule3: B --> F , B EQUAL F, weight(torch)=0.1464.
Rule4: C --> F , C EQUAL F, weight(torch)=0.3295.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4964.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0124.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0949.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.5344.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0654.
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1139.
Rule11: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.1534.
Rule12: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0719.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 28.9453 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 30 candidate rules.
[multiprocess log-grad] Elapsed: 1.7308 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.06042, std=0.77448, Rule = B ^ C --> F , B EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01625, std=0.69002, Rule = E ^ C --> F , E EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01598, std=0.49772, Rule = A ^ C --> F , A EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01007, std=0.44128, Rule = Not A ^ C --> F , Not A EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00457, std=0.49253, Rule = Not B ^ C --> F , Not B EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00096, std=1.02685, Rule = Not A ^ C --> F , Not A BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00124, std=0.52781, Rule = E ^ C --> F , E EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00226, std=0.63533, Rule = Not A ^ C --> F , Not A EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00359, std=2.07425, Rule = Not B ^ C --> F , Not B BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00558, std=0.49274, Rule = B ^ C --> F , B EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00699, std=1.09864, Rule = A ^ C --> F , A BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00963, std=0.64571, Rule = Not E ^ C --> F , Not E EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01100, std=0.53302, Rule = Not D ^ C --> F , Not D EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01561, std=0.55278, Rule = D ^ C --> F , D EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01683, std=0.60568, Rule = D ^ C --> F , D EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02060, std=0.50422, Rule = Not E ^ C --> F , Not E EQUAL C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02154, std=1.04722, Rule = Not D ^ C --> F , Not D BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02307, std=1.10891, Rule = D ^ C --> F , D BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02494, std=0.66777, Rule = A ^ C --> F , A EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03617, std=1.07912, Rule = Not E ^ C --> F , Not E BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03925, std=0.67349, Rule = Not B ^ C --> F , Not B EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04027, std=0.70842, Rule = Not D ^ C --> F , Not D EQUAL F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04314, std=2.12611, Rule = Not E ^ C --> F , Not E BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04363, std=1.09560, Rule = Not B ^ C --> F , Not B BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04398, std=1.11568, Rule = B ^ C --> F , B BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04983, std=2.11228, Rule = Not D ^ C --> F , Not D BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.05972, std=2.19653, Rule = D ^ C --> F , D BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06598, std=1.14249, Rule = E ^ C --> F , E BEFORE C ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07320, std=2.18853, Rule = E ^ C --> F , E BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.09445, std=2.15294, Rule = B ^ C --> F , B BEFORE F ^ C BEFORE F
-------------
Best rule is: B ^ C --> F , B EQUAL F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.060420520222747416
new rule added.
best gain 0.01625329979947149 does not meet thershold 0.02.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1272
Rule0: C --> F , C BEFORE F, weight=0.4938
Rule1: Not C --> F , Not C BEFORE F, weight=0.0646
Rule2: A --> F , A BEFORE F, weight=0.0860
Rule3: B --> F , B EQUAL F, weight=0.1464
Rule4: C --> F , C EQUAL F, weight=0.3295
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4964
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0124
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0949
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5344
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0654
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1139
Rule11: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.1534
Rule12: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0719
Rule13: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1190
Rule0: C --> F , C BEFORE F, weight=0.4561
Rule1: Not C --> F , Not C BEFORE F, weight=0.0795
Rule2: A --> F , A BEFORE F, weight=0.0304
Rule3: B --> F , B EQUAL F, weight=0.1324
Rule4: C --> F , C EQUAL F, weight=0.3653
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4822
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0111
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1026
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5323
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0865
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1132
Rule11: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.2105
Rule12: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0901
Rule13: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.0796
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 3.3251 min.
Update Log-likelihood (torch)=  -5.372484906426029
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1190,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4561.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.0795.
Rule2: A --> F , A BEFORE F, weight(torch)=0.0304.
Rule3: B --> F , B EQUAL F, weight(torch)=0.1324.
Rule4: C --> F , C EQUAL F, weight(torch)=0.3653.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4822.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=0.0111.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1026.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.5323.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0865.
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1132.
Rule11: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.2105.
Rule12: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0901.
Rule13: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.0796.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: C --> F , C EQUAL F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 31.9962 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 32 candidate rules.
[multiprocess log-grad] Elapsed: 1.7369 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.11200, std=0.70760, Rule = D ^ C --> F , D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.10444, std=0.65752, Rule = D ^ C --> F , D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.08729, std=0.66763, Rule = Not D ^ C --> F , Not D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.07892, std=0.62997, Rule = Not D ^ C --> F , Not D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.05496, std=0.67444, Rule = Not B ^ C --> F , Not B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.05487, std=0.68870, Rule = B ^ C --> F , B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.05159, std=0.65001, Rule = B ^ C --> F , B BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.04706, std=0.63693, Rule = Not B ^ C --> F , Not B BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.04449, std=0.65558, Rule = Not E ^ C --> F , Not E BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.04272, std=0.63681, Rule = Not A ^ C --> F , Not A BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.04271, std=0.62294, Rule = Not E ^ C --> F , Not E BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.03477, std=0.65043, Rule = A ^ C --> F , A BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.03373, std=0.59335, Rule = Not A ^ C --> F , Not A BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.03048, std=0.68662, Rule = E ^ C --> F , E BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02883, std=0.59236, Rule = A ^ C --> F , A BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02686, std=0.72069, Rule = E ^ C --> F , E BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02023, std=0.30216, Rule = Not D ^ C --> F , Not D EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01476, std=0.29539, Rule = Not B ^ C --> F , Not B EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01186, std=0.24991, Rule = Not D ^ C --> F , Not D EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00686, std=0.25662, Rule = Not B ^ C --> F , Not B EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00654, std=0.27369, Rule = Not A ^ C --> F , Not A EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00636, std=0.25381, Rule = E ^ C --> F , E EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00275, std=0.28886, Rule = E ^ C --> F , E EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00036, std=0.33778, Rule = B ^ C --> F , B EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00245, std=0.23383, Rule = Not A ^ C --> F , Not A EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00326, std=0.29141, Rule = Not E ^ C --> F , Not E EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00348, std=0.31766, Rule = D ^ C --> F , D EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00363, std=0.30029, Rule = B ^ C --> F , B EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00504, std=0.24990, Rule = Not E ^ C --> F , Not E EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01104, std=0.27446, Rule = D ^ C --> F , D EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01332, std=0.28265, Rule = A ^ C --> F , A EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01926, std=0.24095, Rule = A ^ C --> F , A EQUAL F ^ C EQUAL F
-------------
Best rule is: D ^ C --> F , D BEFORE F ^ C EQUAL F
Best log-likelihood-grad(all-data) = 0.1119989786817982
new rule added.
Best rule is: D ^ C --> F , D BEFORE C ^ C EQUAL F
Best log-likelihood-grad(all-data) = 0.10444156316553917
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1190
Rule0: C --> F , C BEFORE F, weight=0.4561
Rule1: Not C --> F , Not C BEFORE F, weight=0.0795
Rule2: A --> F , A BEFORE F, weight=0.0304
Rule3: B --> F , B EQUAL F, weight=0.1324
Rule4: C --> F , C EQUAL F, weight=0.3653
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4822
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=0.0111
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1026
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5323
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0865
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1132
Rule11: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.2105
Rule12: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0901
Rule13: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.0796
Rule14: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.0100
Rule15: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1323
Rule0: C --> F , C BEFORE F, weight=0.4019
Rule1: Not C --> F , Not C BEFORE F, weight=0.0561
Rule2: A --> F , A BEFORE F, weight=0.0225
Rule3: B --> F , B EQUAL F, weight=0.1317
Rule4: C --> F , C EQUAL F, weight=0.2020
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4762
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight=-0.0042
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0949
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5039
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0792
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1114
Rule11: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.2623
Rule12: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0767
Rule13: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1766
Rule14: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.1675
Rule15: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1527
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 3.8070 min.
Update Log-likelihood (torch)=  -5.2419857492038755
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1323,
Rule0: C --> F , C BEFORE F, weight(torch)=0.4019.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.0561.
Rule2: A --> F , A BEFORE F, weight(torch)=0.0225.
Rule3: B --> F , B EQUAL F, weight(torch)=0.1317.
Rule4: C --> F , C EQUAL F, weight(torch)=0.2020.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4762.
Rule6: Not A ^ Not C --> F , Not A BEFORE F ^ Not C BEFORE F, weight(torch)=-0.0042.
Rule7: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0949.
Rule8: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.5039.
Rule9: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0792.
Rule10: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1114.
Rule11: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.2623.
Rule12: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0767.
Rule13: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.1766.
Rule14: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.1675.
Rule15: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1527.
delete these rules: [6]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1323
Rule0: C --> F , C BEFORE F, weight=0.4019
Rule1: Not C --> F , Not C BEFORE F, weight=0.0561
Rule2: A --> F , A BEFORE F, weight=0.0225
Rule3: B --> F , B EQUAL F, weight=0.1317
Rule4: C --> F , C EQUAL F, weight=0.2020
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4762
Rule6: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0949
Rule7: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.5039
Rule8: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0792
Rule9: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1114
Rule10: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.2623
Rule11: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0767
Rule12: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1766
Rule13: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.1675
Rule14: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1527
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1095
Rule0: C --> F , C BEFORE F, weight=0.3834
Rule1: Not C --> F , Not C BEFORE F, weight=0.0882
Rule2: A --> F , A BEFORE F, weight=-0.0026
Rule3: B --> F , B EQUAL F, weight=0.0775
Rule4: C --> F , C EQUAL F, weight=0.1005
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4514
Rule6: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1218
Rule7: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4641
Rule8: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0974
Rule9: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1222
Rule10: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.3169
Rule11: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0968
Rule12: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2080
Rule13: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2244
Rule14: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1919
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 3.6038 min.
update Log-likelihood (torch)=  -5.218107618100708
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1095,
Rule0: C --> F , C BEFORE F, weight(torch)=0.3834.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.0882.
Rule2: A --> F , A BEFORE F, weight(torch)=-0.0026.
Rule3: B --> F , B EQUAL F, weight(torch)=0.0775.
Rule4: C --> F , C EQUAL F, weight(torch)=0.1005.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4514.
Rule6: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1218.
Rule7: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.4641.
Rule8: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0974.
Rule9: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1222.
Rule10: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.3169.
Rule11: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0968.
Rule12: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.2080.
Rule13: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2244.
Rule14: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1919.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 36.4282 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 30 candidate rules.
[multiprocess log-grad] Elapsed: 1.7817 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.03503, std=0.69181, Rule = B ^ C --> F , B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.03083, std=0.65405, Rule = B ^ C --> F , B BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02980, std=0.68082, Rule = Not B ^ C --> F , Not B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02331, std=0.69268, Rule = Not D ^ C --> F , Not D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02313, std=0.64258, Rule = Not B ^ C --> F , Not B BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02045, std=0.64283, Rule = Not A ^ C --> F , Not A BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01794, std=0.65416, Rule = Not D ^ C --> F , Not D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01642, std=0.66467, Rule = Not E ^ C --> F , Not E BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01586, std=0.63117, Rule = Not E ^ C --> F , Not E BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01524, std=0.65976, Rule = A ^ C --> F , A BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01292, std=0.29012, Rule = Not B ^ C --> F , Not B EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01211, std=0.30878, Rule = Not D ^ C --> F , Not D EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01200, std=0.59902, Rule = Not A ^ C --> F , Not A BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01088, std=0.59597, Rule = A ^ C --> F , A BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00765, std=0.25531, Rule = E ^ C --> F , E EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00720, std=0.69649, Rule = E ^ C --> F , E BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00674, std=0.25654, Rule = Not D ^ C --> F , Not D EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00625, std=0.25113, Rule = Not B ^ C --> F , Not B EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00526, std=0.28791, Rule = E ^ C --> F , E EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00487, std=0.32785, Rule = B ^ C --> F , B EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00481, std=0.72970, Rule = E ^ C --> F , E BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00346, std=0.27418, Rule = Not A ^ C --> F , Not A EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00067, std=0.28891, Rule = B ^ C --> F , B EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00331, std=0.31638, Rule = D ^ C --> F , D EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00499, std=0.23713, Rule = Not A ^ C --> F , Not A EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00611, std=0.29577, Rule = Not E ^ C --> F , Not E EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00667, std=0.25483, Rule = Not E ^ C --> F , Not E EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00732, std=0.27079, Rule = D ^ C --> F , D EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01490, std=0.28057, Rule = A ^ C --> F , A EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01925, std=0.23799, Rule = A ^ C --> F , A EQUAL F ^ C EQUAL F
-------------
Best rule is: B ^ C --> F , B BEFORE F ^ C EQUAL F
Best log-likelihood-grad(all-data) = 0.035031735475548345
new rule added.
Best rule is: B ^ C --> F , B BEFORE C ^ C EQUAL F
Best log-likelihood-grad(all-data) = 0.030830275191558697
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1095
Rule0: C --> F , C BEFORE F, weight=0.3834
Rule1: Not C --> F , Not C BEFORE F, weight=0.0882
Rule2: A --> F , A BEFORE F, weight=-0.0026
Rule3: B --> F , B EQUAL F, weight=0.0775
Rule4: C --> F , C EQUAL F, weight=0.1005
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4514
Rule6: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1218
Rule7: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4641
Rule8: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0974
Rule9: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1222
Rule10: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.3169
Rule11: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0968
Rule12: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2080
Rule13: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2244
Rule14: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1919
Rule15: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0100
Rule16: B ^ C --> F , B BEFORE C ^ C EQUAL F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1264
Rule0: C --> F , C BEFORE F, weight=0.3280
Rule1: Not C --> F , Not C BEFORE F, weight=0.1063
Rule2: A --> F , A BEFORE F, weight=-0.0052
Rule3: B --> F , B EQUAL F, weight=0.0843
Rule4: C --> F , C EQUAL F, weight=0.0083
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4266
Rule6: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1253
Rule7: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4610
Rule8: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0748
Rule9: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0666
Rule10: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.3288
Rule11: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0991
Rule12: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2412
Rule13: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2605
Rule14: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.2106
Rule15: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0829
Rule16: B ^ C --> F , B BEFORE C ^ C EQUAL F, weight=0.0256
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 4.0955 min.
Update Log-likelihood (torch)=  -5.225003476105537
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1264,
Rule0: C --> F , C BEFORE F, weight(torch)=0.3280.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.1063.
Rule2: A --> F , A BEFORE F, weight(torch)=-0.0052.
Rule3: B --> F , B EQUAL F, weight(torch)=0.0843.
Rule4: C --> F , C EQUAL F, weight(torch)=0.0083.
Rule5: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4266.
Rule6: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1253.
Rule7: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.4610.
Rule8: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0748.
Rule9: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0666.
Rule10: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.3288.
Rule11: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0991.
Rule12: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.2412.
Rule13: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2605.
Rule14: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.2106.
Rule15: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0829.
Rule16: B ^ C --> F , B BEFORE C ^ C EQUAL F, weight(torch)=0.0256.
delete these rules: [2, 4]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1264
Rule0: C --> F , C BEFORE F, weight=0.3280
Rule1: Not C --> F , Not C BEFORE F, weight=0.1063
Rule2: B --> F , B EQUAL F, weight=0.0843
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4266
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1253
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4610
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0748
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0666
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.3288
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0991
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2412
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2605
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.2106
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0829
Rule14: B ^ C --> F , B BEFORE C ^ C EQUAL F, weight=0.0256
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1301
Rule0: C --> F , C BEFORE F, weight=0.2859
Rule1: Not C --> F , Not C BEFORE F, weight=0.1475
Rule2: B --> F , B EQUAL F, weight=0.0655
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4145
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1484
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4154
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0696
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0870
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.3836
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0852
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2916
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2376
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1972
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1013
Rule14: B ^ C --> F , B BEFORE C ^ C EQUAL F, weight=0.0041
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 3.7613 min.
update Log-likelihood (torch)=  -5.191885985365646
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1301,
Rule0: C --> F , C BEFORE F, weight(torch)=0.2859.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.1475.
Rule2: B --> F , B EQUAL F, weight(torch)=0.0655.
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.4145.
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1484.
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.4154.
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0696.
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0870.
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.3836.
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0852.
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.2916.
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2376.
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1972.
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.1013.
Rule14: B ^ C --> F , B BEFORE C ^ C EQUAL F, weight(torch)=0.0041.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 36.3551 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 15 candidate rules.
[multiprocess log-grad] Elapsed: 56.5038 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.02434, std=0.69354, Rule = Not D ^ C --> F , Not D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02042, std=0.64598, Rule = Not A ^ C --> F , Not A BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02031, std=0.69229, Rule = Not B ^ C --> F , Not B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01874, std=0.65437, Rule = Not D ^ C --> F , Not D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01588, std=0.66337, Rule = A ^ C --> F , A BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01397, std=0.65441, Rule = Not B ^ C --> F , Not B BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01361, std=0.67231, Rule = Not E ^ C --> F , Not E BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01310, std=0.63834, Rule = Not E ^ C --> F , Not E BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01255, std=0.30924, Rule = Not D ^ C --> F , Not D EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01195, std=0.29193, Rule = Not B ^ C --> F , Not B EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01152, std=0.60286, Rule = Not A ^ C --> F , Not A BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01149, std=0.59881, Rule = A ^ C --> F , A BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00696, std=0.25648, Rule = Not D ^ C --> F , Not D EQUAL F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00673, std=0.70406, Rule = E ^ C --> F , E BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00481, std=0.73682, Rule = E ^ C --> F , E BEFORE F ^ C EQUAL F
-------------
Best rule is: Not D ^ C --> F , Not D BEFORE F ^ C EQUAL F
Best log-likelihood-grad(all-data) = 0.02433610429699328
new rule added.
Best rule is: Not A ^ C --> F , Not A BEFORE F ^ C EQUAL F
Best log-likelihood-grad(all-data) = 0.020416008035310646
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1301
Rule0: C --> F , C BEFORE F, weight=0.2859
Rule1: Not C --> F , Not C BEFORE F, weight=0.1475
Rule2: B --> F , B EQUAL F, weight=0.0655
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.4145
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1484
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4154
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0696
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0870
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.3836
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0852
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2916
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2376
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1972
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1013
Rule14: B ^ C --> F , B BEFORE C ^ C EQUAL F, weight=0.0041
Rule15: Not D ^ C --> F , Not D BEFORE F ^ C EQUAL F, weight=0.0100
Rule16: Not A ^ C --> F , Not A BEFORE F ^ C EQUAL F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1297
Rule0: C --> F , C BEFORE F, weight=0.2733
Rule1: Not C --> F , Not C BEFORE F, weight=0.1844
Rule2: B --> F , B EQUAL F, weight=0.0688
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3784
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1161
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3984
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0679
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1164
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4169
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0592
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.3292
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2565
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1949
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0673
Rule14: B ^ C --> F , B BEFORE C ^ C EQUAL F, weight=-0.0011
Rule15: Not D ^ C --> F , Not D BEFORE F ^ C EQUAL F, weight=0.0097
Rule16: Not A ^ C --> F , Not A BEFORE F ^ C EQUAL F, weight=0.0074
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 4.2772 min.
Update Log-likelihood (torch)=  -5.2202874963076145
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1297,
Rule0: C --> F , C BEFORE F, weight(torch)=0.2733.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.1844.
Rule2: B --> F , B EQUAL F, weight(torch)=0.0688.
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.3784.
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1161.
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.3984.
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0679.
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1164.
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4169.
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0592.
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.3292.
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2565.
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1949.
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0673.
Rule14: B ^ C --> F , B BEFORE C ^ C EQUAL F, weight(torch)=-0.0011.
Rule15: Not D ^ C --> F , Not D BEFORE F ^ C EQUAL F, weight(torch)=0.0097.
Rule16: Not A ^ C --> F , Not A BEFORE F ^ C EQUAL F, weight(torch)=0.0074.
delete these rules: [14, 15, 16]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1297
Rule0: C --> F , C BEFORE F, weight=0.2733
Rule1: Not C --> F , Not C BEFORE F, weight=0.1844
Rule2: B --> F , B EQUAL F, weight=0.0688
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3784
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1161
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3984
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0679
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1164
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4169
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0592
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.3292
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2565
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1949
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0673
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1307
Rule0: C --> F , C BEFORE F, weight=0.2819
Rule1: Not C --> F , Not C BEFORE F, weight=0.2019
Rule2: B --> F , B EQUAL F, weight=0.0536
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3452
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1258
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4073
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0619
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1211
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4601
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0707
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.3606
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2794
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.2210
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1130
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 3.5205 min.
update Log-likelihood (torch)=  -5.244780330916592
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1307,
Rule0: C --> F , C BEFORE F, weight(torch)=0.2819.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.2019.
Rule2: B --> F , B EQUAL F, weight(torch)=0.0536.
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.3452.
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1258.
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.4073.
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0619.
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1211.
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4601.
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0707.
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.3606.
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2794.
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.2210.
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.1130.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 33.0064 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 10 candidate rules.
[multiprocess log-grad] Elapsed: 50.9159 sec.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.00602, std=0.29851, Rule = Not B ^ C --> F , Not B EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00571, std=0.31609, Rule = Not D ^ C --> F , Not D EQUAL C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01450, std=0.71313, Rule = Not B ^ C --> F , Not B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01558, std=0.61446, Rule = Not A ^ C --> F , Not A BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01634, std=0.67864, Rule = A ^ C --> F , A BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01767, std=0.65350, Rule = Not E ^ C --> F , Not E BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01861, std=0.68765, Rule = Not E ^ C --> F , Not E BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01880, std=0.61170, Rule = A ^ C --> F , A BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01916, std=0.67483, Rule = Not B ^ C --> F , Not B BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01959, std=0.67581, Rule = Not D ^ C --> F , Not D BEFORE C ^ C EQUAL F
-------------
best gain 0.006018952838918586 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: B --> F , B EQUAL F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 33.6690 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 30 candidate rules.
[multiprocess log-grad] Elapsed: 1.7539 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.07256, std=0.74690, Rule = A ^ B --> F , A BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.05887, std=0.78919, Rule = D ^ B --> F , D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.05864, std=0.76718, Rule = Not D ^ B --> F , Not D BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.05730, std=0.68829, Rule = A ^ B --> F , A BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.05653, std=0.81887, Rule = D ^ B --> F , D BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.05645, std=0.72982, Rule = Not D ^ B --> F , Not D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.05521, std=0.70618, Rule = Not A ^ B --> F , Not A BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.04944, std=0.67457, Rule = Not A ^ B --> F , Not A BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01884, std=0.29632, Rule = Not C ^ B --> F , Not C EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01472, std=0.34057, Rule = Not C ^ B --> F , Not C EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01227, std=0.31144, Rule = A ^ B --> F , A EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00841, std=0.82993, Rule = E ^ B --> F , E BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00658, std=0.25452, Rule = Not E ^ B --> F , Not E EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00641, std=0.30137, Rule = Not E ^ B --> F , Not E EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00495, std=0.84352, Rule = C ^ B --> F , C BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00287, std=0.87341, Rule = E ^ B --> F , E BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00091, std=0.81931, Rule = Not E ^ B --> F , Not E BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00073, std=0.85266, Rule = Not E ^ B --> F , Not E BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00020, std=0.29908, Rule = Not D ^ B --> F , Not D EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00035, std=0.28986, Rule = Not A ^ B --> F , Not A EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00094, std=0.27757, Rule = E ^ B --> F , E EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00239, std=0.26514, Rule = Not D ^ B --> F , Not D EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00285, std=0.28142, Rule = D ^ B --> F , D EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00299, std=0.24905, Rule = A ^ B --> F , A EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00342, std=0.29782, Rule = C ^ B --> F , C EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00519, std=0.30299, Rule = D ^ B --> F , D EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00612, std=0.26292, Rule = Not A ^ B --> F , Not A EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00648, std=0.32134, Rule = E ^ B --> F , E EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01287, std=0.77202, Rule = Not C ^ B --> F , Not C BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01559, std=0.39850, Rule = C ^ B --> F , C EQUAL B ^ B EQUAL F
-------------
Best rule is: A ^ B --> F , A BEFORE F ^ B EQUAL F
Best log-likelihood-grad(all-data) = 0.07256396366774946
new rule added.
Best rule is: D ^ B --> F , D BEFORE B ^ B EQUAL F
Best log-likelihood-grad(all-data) = 0.05886859293708672
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1307
Rule0: C --> F , C BEFORE F, weight=0.2819
Rule1: Not C --> F , Not C BEFORE F, weight=0.2019
Rule2: B --> F , B EQUAL F, weight=0.0536
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3452
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1258
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.4073
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0619
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1211
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4601
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0707
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.3606
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2794
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.2210
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1130
Rule14: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0100
Rule15: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1354
Rule0: C --> F , C BEFORE F, weight=0.2624
Rule1: Not C --> F , Not C BEFORE F, weight=0.2173
Rule2: B --> F , B EQUAL F, weight=0.0319
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3187
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1346
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3323
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0523
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1536
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4662
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0691
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.3493
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2919
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.2153
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1250
Rule14: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0881
Rule15: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1109
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 4.0348 min.
Update Log-likelihood (torch)=  -5.225865950057345
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1354,
Rule0: C --> F , C BEFORE F, weight(torch)=0.2624.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.2173.
Rule2: B --> F , B EQUAL F, weight(torch)=0.0319.
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.3187.
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1346.
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.3323.
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0523.
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1536.
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4662.
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0691.
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.3493.
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2919.
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.2153.
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.1250.
Rule14: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=0.0881.
Rule15: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1109.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 38.5138 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 28 candidate rules.
[multiprocess log-grad] Elapsed: 1.6807 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.01939, std=0.72164, Rule = Not A ^ B --> F , Not A BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01882, std=0.70193, Rule = A ^ B --> F , A BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01860, std=0.78329, Rule = Not D ^ B --> F , Not D BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01844, std=0.74608, Rule = Not D ^ B --> F , Not D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01571, std=0.68803, Rule = Not A ^ B --> F , Not A BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01461, std=0.29689, Rule = Not C ^ B --> F , Not C EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00974, std=0.33995, Rule = Not C ^ B --> F , Not C EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00886, std=0.83567, Rule = D ^ B --> F , D BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00491, std=0.31691, Rule = A ^ B --> F , A EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00302, std=0.25449, Rule = Not E ^ B --> F , Not E EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00100, std=0.30274, Rule = Not E ^ B --> F , Not E EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00507, std=0.28080, Rule = D ^ B --> F , D EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00528, std=0.28426, Rule = E ^ B --> F , E EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00603, std=0.29202, Rule = Not A ^ B --> F , Not A EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00628, std=0.25334, Rule = A ^ B --> F , A EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00726, std=0.30390, Rule = Not D ^ B --> F , Not D EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00743, std=0.27069, Rule = Not D ^ B --> F , Not D EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00849, std=0.30209, Rule = D ^ B --> F , D EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00910, std=0.30280, Rule = C ^ B --> F , C EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00926, std=0.82697, Rule = C ^ B --> F , C BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00971, std=0.26313, Rule = Not A ^ B --> F , Not A EQUAL F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01268, std=0.32631, Rule = E ^ B --> F , E EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02209, std=0.39882, Rule = C ^ B --> F , C EQUAL B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02400, std=0.83753, Rule = E ^ B --> F , E BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02490, std=0.75912, Rule = Not C ^ B --> F , Not C BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02980, std=0.82453, Rule = Not E ^ B --> F , Not E BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.03139, std=0.88112, Rule = E ^ B --> F , E BEFORE F ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.03182, std=0.85864, Rule = Not E ^ B --> F , Not E BEFORE F ^ B EQUAL F
-------------
best gain 0.01939135622554911 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: A ^ C --> F , A BEFORE F ^ C BEFORE F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 38.2580 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.6093 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.06106, std=0.66946, Rule = B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02895, std=0.44755, Rule = Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01902, std=2.06583, Rule = Not B ^ A ^ C --> F , Not B BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01583, std=0.53172, Rule = E ^ A ^ C --> F , E EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01581, std=0.64853, Rule = E ^ A ^ C --> F , E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01396, std=0.59465, Rule = Not E ^ A ^ C --> F , Not E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01166, std=0.41600, Rule = B ^ A ^ C --> F , B EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00661, std=1.07101, Rule = Not D ^ A ^ C --> F , Not D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00640, std=0.44027, Rule = Not B ^ A ^ C --> F , Not B EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00293, std=0.66372, Rule = Not E ^ A ^ C --> F , Not E EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00174, std=1.22528, Rule = B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00036, std=0.55147, Rule = D ^ A ^ C --> F , D EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00074, std=0.42112, Rule = Not D ^ A ^ C --> F , Not D EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00212, std=0.58405, Rule = D ^ A ^ C --> F , D EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00278, std=0.56928, Rule = E ^ A ^ C --> F , E EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00280, std=0.50001, Rule = D ^ A ^ C --> F , D EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00571, std=1.12783, Rule = D ^ A ^ C --> F , D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00714, std=1.11961, Rule = Not D ^ A ^ C --> F , Not D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00915, std=1.13285, Rule = D ^ A ^ C --> F , D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00928, std=0.66184, Rule = Not E ^ A ^ C --> F , Not E EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00934, std=0.46881, Rule = B ^ A ^ C --> F , B EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01203, std=1.29803, Rule = E ^ A ^ C --> F , E BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01369, std=0.63350, Rule = Not D ^ A ^ C --> F , Not D EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01661, std=1.26990, Rule = Not E ^ A ^ C --> F , Not E BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01747, std=2.50031, Rule = Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01781, std=1.26522, Rule = Not E ^ A ^ C --> F , Not E BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01828, std=1.18140, Rule = Not B ^ A ^ C --> F , Not B BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01829, std=0.64136, Rule = Not B ^ A ^ C --> F , Not B EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02273, std=1.17393, Rule = B ^ A ^ C --> F , B BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02788, std=0.75327, Rule = Not D ^ A ^ C --> F , Not D EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03236, std=2.48322, Rule = E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03294, std=1.36972, Rule = E ^ A ^ C --> F , E BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03909, std=2.05889, Rule = B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04084, std=2.33771, Rule = D ^ A ^ C --> F , D BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04120, std=1.20902, Rule = Not B ^ A ^ C --> F , Not B BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04781, std=2.32567, Rule = Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
Best rule is: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.06105603360563337
new rule added.
Best rule is: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.028950284101518113
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1354
Rule0: C --> F , C BEFORE F, weight=0.2624
Rule1: Not C --> F , Not C BEFORE F, weight=0.2173
Rule2: B --> F , B EQUAL F, weight=0.0319
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3187
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1346
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.3323
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0523
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1536
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4662
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0691
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.3493
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2919
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.2153
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1250
Rule14: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0881
Rule15: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1109
Rule16: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.0100
Rule17: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1308
Rule0: C --> F , C BEFORE F, weight=0.2282
Rule1: Not C --> F , Not C BEFORE F, weight=0.2356
Rule2: B --> F , B EQUAL F, weight=-0.0490
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.2921
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1306
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.2497
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0620
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1278
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4857
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0699
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2900
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2788
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1810
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0987
Rule14: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.1313
Rule15: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1480
Rule16: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.1494
Rule17: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1293
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 5.3565 min.
Update Log-likelihood (torch)=  -5.235347157422081
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1308,
Rule0: C --> F , C BEFORE F, weight(torch)=0.2282.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.2356.
Rule2: B --> F , B EQUAL F, weight(torch)=-0.0490.
Rule3: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.2921.
Rule4: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1306.
Rule5: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.2497.
Rule6: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0620.
Rule7: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1278.
Rule8: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4857.
Rule9: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0699.
Rule10: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.2900.
Rule11: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2788.
Rule12: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1810.
Rule13: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0987.
Rule14: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=0.1313.
Rule15: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1480.
Rule16: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1494.
Rule17: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1293.
delete these rules: [2]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1308
Rule0: C --> F , C BEFORE F, weight=0.2282
Rule1: Not C --> F , Not C BEFORE F, weight=0.2356
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.2921
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1306
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.2497
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0620
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1278
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4857
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0699
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2900
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2788
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1810
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0987
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.1313
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1480
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.1494
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1293
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1304
Rule0: C --> F , C BEFORE F, weight=0.2076
Rule1: Not C --> F , Not C BEFORE F, weight=0.2610
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3004
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1218
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.2245
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0448
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0981
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4789
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0588
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2497
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2719
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1540
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0732
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.1141
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1530
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.2364
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1429
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 5.1513 min.
update Log-likelihood (torch)=  -5.176145006189112
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1304,
Rule0: C --> F , C BEFORE F, weight(torch)=0.2076.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.2610.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.3004.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1218.
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.2245.
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0448.
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0981.
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4789.
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0588.
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.2497.
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2719.
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1540.
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0732.
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=0.1141.
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1530.
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.2364.
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1429.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 49.6625 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 34 candidate rules.
[multiprocess log-grad] Elapsed: 5.5250 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.10792, std=2.00487, Rule = Not B ^ A ^ C --> F , Not B BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.10191, std=2.32726, Rule = Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.09065, std=2.31539, Rule = E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.08436, std=2.21735, Rule = D ^ A ^ C --> F , D BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.06965, std=2.19767, Rule = Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.06375, std=1.99851, Rule = B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.05388, std=1.02384, Rule = Not D ^ A ^ C --> F , Not D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.04565, std=1.07868, Rule = D ^ A ^ C --> F , D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.04515, std=1.17691, Rule = B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03745, std=1.09444, Rule = D ^ A ^ C --> F , D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03734, std=1.21275, Rule = E ^ A ^ C --> F , E BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03640, std=1.08133, Rule = Not D ^ A ^ C --> F , Not D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03577, std=1.17696, Rule = Not E ^ A ^ C --> F , Not E BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03060, std=0.63162, Rule = E ^ A ^ C --> F , E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03007, std=0.50715, Rule = E ^ A ^ C --> F , E EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02866, std=1.18408, Rule = Not E ^ A ^ C --> F , Not E BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02723, std=1.11787, Rule = B ^ A ^ C --> F , B BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02720, std=0.58506, Rule = Not E ^ A ^ C --> F , Not E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02465, std=1.26648, Rule = E ^ A ^ C --> F , E BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02043, std=1.13352, Rule = Not B ^ A ^ C --> F , Not B BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02001, std=0.41449, Rule = B ^ A ^ C --> F , B EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01581, std=0.61396, Rule = Not E ^ A ^ C --> F , Not E EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01415, std=0.54880, Rule = D ^ A ^ C --> F , D EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01350, std=0.43478, Rule = Not B ^ A ^ C --> F , Not B EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01258, std=0.54594, Rule = D ^ A ^ C --> F , D EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01219, std=0.47219, Rule = D ^ A ^ C --> F , D EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01175, std=0.53737, Rule = E ^ A ^ C --> F , E EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01093, std=0.40349, Rule = Not D ^ A ^ C --> F , Not D EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00894, std=1.13790, Rule = Not B ^ A ^ C --> F , Not B BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00645, std=0.60861, Rule = Not E ^ A ^ C --> F , Not E EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00193, std=0.59340, Rule = Not D ^ A ^ C --> F , Not D EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00156, std=0.46878, Rule = B ^ A ^ C --> F , B EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00740, std=0.63921, Rule = Not B ^ A ^ C --> F , Not B EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01399, std=0.73361, Rule = Not D ^ A ^ C --> F , Not D EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
Best rule is: Not B ^ A ^ C --> F , Not B BEFORE F ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.10791912445742857
new rule added.
Best rule is: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.10191065313215274
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1304
Rule0: C --> F , C BEFORE F, weight=0.2076
Rule1: Not C --> F , Not C BEFORE F, weight=0.2610
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.3004
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1218
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.2245
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0448
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0981
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4789
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0588
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2497
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2719
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1540
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0732
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.1141
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1530
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.2364
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1429
Rule17: Not B ^ A ^ C --> F , Not B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0100
Rule18: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1261
Rule0: C --> F , C BEFORE F, weight=0.1975
Rule1: Not C --> F , Not C BEFORE F, weight=0.3015
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.2499
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1320
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.1646
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0544
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1081
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4756
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0702
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2403
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3029
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1646
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0976
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0889
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1662
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.3285
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1353
Rule17: Not B ^ A ^ C --> F , Not B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=-0.0026
Rule18: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0349
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 6.4637 min.
Update Log-likelihood (torch)=  -5.180071928928252
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1261,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1975.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.3015.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.2499.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1320.
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.1646.
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0544.
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1081.
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4756.
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0702.
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.2403.
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3029.
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1646.
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0976.
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=0.0889.
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1662.
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.3285.
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1353.
Rule17: Not B ^ A ^ C --> F , Not B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=-0.0026.
Rule18: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0349.
delete these rules: [17]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1261
Rule0: C --> F , C BEFORE F, weight=0.1975
Rule1: Not C --> F , Not C BEFORE F, weight=0.3015
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.2499
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1320
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.1646
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0544
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1081
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4756
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0702
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.2403
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3029
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1646
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0976
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0889
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1662
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.3285
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1353
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0349
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1247
Rule0: C --> F , C BEFORE F, weight=0.2036
Rule1: Not C --> F , Not C BEFORE F, weight=0.3068
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.2382
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1007
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.1191
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0606
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1393
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4777
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0635
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1956
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2789
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1371
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0823
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0630
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1689
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.4306
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1397
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0377
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 5.8197 min.
update Log-likelihood (torch)=  -5.171031655204004
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1247,
Rule0: C --> F , C BEFORE F, weight(torch)=0.2036.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.3068.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.2382.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.1007.
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.1191.
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0606.
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1393.
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4777.
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0635.
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.1956.
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2789.
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1371.
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0823.
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=0.0630.
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1689.
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.4306.
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1397.
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0377.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 56.9802 sec.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 26 candidate rules.
[multiprocess log-grad] Elapsed: 3.8410 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.03369, std=2.23332, Rule = D ^ A ^ C --> F , D BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03310, std=2.51061, Rule = E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03029, std=1.03394, Rule = Not D ^ A ^ C --> F , Not D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02913, std=1.21890, Rule = B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02552, std=0.63531, Rule = E ^ A ^ C --> F , E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02512, std=2.02426, Rule = B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02425, std=0.58781, Rule = Not E ^ A ^ C --> F , Not E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02331, std=2.20851, Rule = Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02133, std=0.54127, Rule = E ^ A ^ C --> F , E EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01994, std=1.08644, Rule = Not D ^ A ^ C --> F , Not D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01973, std=1.09833, Rule = D ^ A ^ C --> F , D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01966, std=1.10716, Rule = D ^ A ^ C --> F , D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01458, std=0.42690, Rule = B ^ A ^ C --> F , B EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01405, std=1.31474, Rule = E ^ A ^ C --> F , E BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01013, std=0.43866, Rule = Not B ^ A ^ C --> F , Not B EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00820, std=0.55080, Rule = D ^ A ^ C --> F , D EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00701, std=0.55528, Rule = D ^ A ^ C --> F , D EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00681, std=0.68854, Rule = Not E ^ A ^ C --> F , Not E EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00632, std=0.40713, Rule = Not D ^ A ^ C --> F , Not D EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00610, std=0.48134, Rule = D ^ A ^ C --> F , D EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00598, std=1.27608, Rule = Not E ^ A ^ C --> F , Not E BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00499, std=1.28613, Rule = Not E ^ A ^ C --> F , Not E BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00489, std=0.57454, Rule = E ^ A ^ C --> F , E EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00420, std=1.18220, Rule = Not B ^ A ^ C --> F , Not B BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00352, std=1.16690, Rule = B ^ A ^ C --> F , B BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00677, std=1.38842, Rule = E ^ A ^ C --> F , E BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
Best rule is: D ^ A ^ C --> F , D BEFORE F ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.03368621992166318
new rule added.
Best rule is: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.03309681072203868
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1247
Rule0: C --> F , C BEFORE F, weight=0.2036
Rule1: Not C --> F , Not C BEFORE F, weight=0.3068
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.2382
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.1007
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.1191
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0606
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1393
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4777
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0635
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1956
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2789
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1371
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0823
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0630
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1689
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.4306
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1397
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0377
Rule18: D ^ A ^ C --> F , D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0100
Rule19: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1396
Rule0: C --> F , C BEFORE F, weight=0.1678
Rule1: Not C --> F , Not C BEFORE F, weight=0.3652
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.2209
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0994
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0982
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0252
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1863
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4750
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0774
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1988
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3086
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1877
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1165
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0308
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2170
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.5011
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1489
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0722
Rule18: D ^ A ^ C --> F , D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0061
Rule19: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0148
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 7.1877 min.
Update Log-likelihood (torch)=  -5.175770910964722
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1396,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1678.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.3652.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.2209.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0994.
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.0982.
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0252.
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1863.
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4750.
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0774.
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.1988.
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3086.
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1877.
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.1165.
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=0.0308.
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.2170.
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.5011.
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1489.
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0722.
Rule18: D ^ A ^ C --> F , D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0061.
Rule19: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0148.
delete these rules: [18]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1396
Rule0: C --> F , C BEFORE F, weight=0.1678
Rule1: Not C --> F , Not C BEFORE F, weight=0.3652
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.2209
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0994
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0982
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0252
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1863
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4750
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0774
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1988
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3086
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1877
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1165
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0308
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2170
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.5011
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1489
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0722
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0148
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1306
Rule0: C --> F , C BEFORE F, weight=0.1563
Rule1: Not C --> F , Not C BEFORE F, weight=0.4054
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1992
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0744
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0593
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0453
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1676
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4663
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0602
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1461
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2972
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1477
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0859
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0079
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1895
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.5699
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1725
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0643
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0096
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 6.5502 min.
update Log-likelihood (torch)=  -5.1834495744334
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1306,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1563.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4054.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1992.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0744.
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.0593.
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0453.
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1676.
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4663.
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0602.
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.1461.
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.2972.
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1477.
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0859.
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=0.0079.
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1895.
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.5699.
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1725.
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0643.
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0096.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.0458 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 13 candidate rules.
[multiprocess log-grad] Elapsed: 2.0308 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.03860, std=2.16487, Rule = Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03808, std=1.02261, Rule = Not D ^ A ^ C --> F , Not D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03392, std=2.05017, Rule = B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03211, std=1.26182, Rule = B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02797, std=0.63005, Rule = E ^ A ^ C --> F , E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02765, std=1.09747, Rule = D ^ A ^ C --> F , D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02641, std=1.07807, Rule = Not D ^ A ^ C --> F , Not D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02622, std=1.11009, Rule = D ^ A ^ C --> F , D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02569, std=0.59002, Rule = Not E ^ A ^ C --> F , Not E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.02009, std=0.57130, Rule = E ^ A ^ C --> F , E EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01598, std=0.43238, Rule = B ^ A ^ C --> F , B EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01265, std=1.40825, Rule = E ^ A ^ C --> F , E BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01083, std=0.44401, Rule = Not B ^ A ^ C --> F , Not B EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
Best rule is: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.03860105347420848
new rule added.
Best rule is: Not D ^ A ^ C --> F , Not D BEFORE C ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.03807600549030467
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1306
Rule0: C --> F , C BEFORE F, weight=0.1563
Rule1: Not C --> F , Not C BEFORE F, weight=0.4054
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1992
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0744
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0593
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0453
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1676
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4663
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0602
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1461
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.2972
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1477
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0859
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0079
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1895
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.5699
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1725
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0643
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0096
Rule19: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0100
Rule20: Not D ^ A ^ C --> F , Not D BEFORE C ^ A BEFORE F ^ C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1429
Rule0: C --> F , C BEFORE F, weight=0.1411
Rule1: Not C --> F , Not C BEFORE F, weight=0.4261
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1904
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0789
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0675
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0420
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0989
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4650
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0606
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1445
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3044
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1366
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0831
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0165
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2069
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.6161
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1324
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0807
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0249
Rule19: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0233
Rule20: Not D ^ A ^ C --> F , Not D BEFORE C ^ A BEFORE F ^ C BEFORE F, weight=0.0074
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 7.7908 min.
Update Log-likelihood (torch)=  -5.167491467670148
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1429,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1411.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4261.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1904.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0789.
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.0675.
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0420.
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0989.
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4650.
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0606.
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.1445.
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3044.
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1366.
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0831.
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=0.0165.
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.2069.
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.6161.
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1324.
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0807.
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0249.
Rule19: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0233.
Rule20: Not D ^ A ^ C --> F , Not D BEFORE C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0074.
delete these rules: [20]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1429
Rule0: C --> F , C BEFORE F, weight=0.1411
Rule1: Not C --> F , Not C BEFORE F, weight=0.4261
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1904
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0789
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0675
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0420
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0989
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4650
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0606
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1445
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3044
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1366
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0831
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=0.0165
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2069
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.6161
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1324
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0807
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0249
Rule19: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0233
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1159
Rule0: C --> F , C BEFORE F, weight=0.1180
Rule1: Not C --> F , Not C BEFORE F, weight=0.4469
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1858
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0380
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0645
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0277
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1220
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4650
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0441
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1204
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3148
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1173
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1055
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=-0.0057
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1989
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.6592
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1318
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0636
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0066
Rule19: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0051
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 7.2120 min.
update Log-likelihood (torch)=  -5.201985741736812
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1159,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1180.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4469.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1858.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0380.
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.0645.
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0277.
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1220.
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4650.
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0441.
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.1204.
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3148.
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1173.
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.1055.
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=-0.0057.
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1989.
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.6592.
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1318.
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0636.
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0066.
Rule19: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0051.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.1403 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 11 candidate rules.
[multiprocess log-grad] Elapsed: 1.9878 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.23509, std=1.86604, Rule = B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.12810, std=1.11922, Rule = B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.12757, std=0.99980, Rule = D ^ A ^ C --> F , D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.12041, std=1.01957, Rule = D ^ A ^ C --> F , D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.11493, std=1.19227, Rule = E ^ A ^ C --> F , E BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.11434, std=0.98519, Rule = Not D ^ A ^ C --> F , Not D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.05405, std=0.60258, Rule = E ^ A ^ C --> F , E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.04885, std=0.50091, Rule = E ^ A ^ C --> F , E EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.04628, std=0.57405, Rule = Not E ^ A ^ C --> F , Not E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03731, std=0.41589, Rule = B ^ A ^ C --> F , B EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.03267, std=0.40904, Rule = Not B ^ A ^ C --> F , Not B EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
Best rule is: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.23508938351275077
new rule added.
Best rule is: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F
Best log-likelihood-grad(all-data) = 0.12810097505145815
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1159
Rule0: C --> F , C BEFORE F, weight=0.1180
Rule1: Not C --> F , Not C BEFORE F, weight=0.4469
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1858
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0380
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0645
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0277
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1220
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4650
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0441
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1204
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3148
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1173
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1055
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=-0.0057
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1989
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.6592
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1318
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0636
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0066
Rule19: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0051
Rule20: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0100
Rule21: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1356
Rule0: C --> F , C BEFORE F, weight=0.1401
Rule1: Not C --> F , Not C BEFORE F, weight=0.4697
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1889
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0524
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight=0.0074
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0432
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1246
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4849
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0729
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.0976
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3558
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1140
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1037
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight=-0.0028
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2408
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.6701
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1147
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0821
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0085
Rule19: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=-0.0090
Rule20: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0157
Rule21: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0106
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 8.4404 min.
Update Log-likelihood (torch)=  -5.16577556603557
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1356,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1401.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4697.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1889.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0524.
Rule4: B ^ Not C --> F , B EQUAL F ^ Not C BEFORE F, weight(torch)=0.0074.
Rule5: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0432.
Rule6: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1246.
Rule7: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4849.
Rule8: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0729.
Rule9: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.0976.
Rule10: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3558.
Rule11: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1140.
Rule12: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.1037.
Rule13: A ^ B --> F , A BEFORE F ^ B EQUAL F, weight(torch)=-0.0028.
Rule14: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.2408.
Rule15: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.6701.
Rule16: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1147.
Rule17: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0821.
Rule18: E ^ A ^ C --> F , E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0085.
Rule19: Not D ^ A ^ C --> F , Not D BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=-0.0090.
Rule20: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0157.
Rule21: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0106.
delete these rules: [4, 13, 18, 19]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1356
Rule0: C --> F , C BEFORE F, weight=0.1401
Rule1: Not C --> F , Not C BEFORE F, weight=0.4697
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1889
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0524
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0432
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1246
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4849
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0729
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.0976
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3558
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1140
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1037
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2408
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.6701
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1147
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0821
Rule16: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0157
Rule17: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0106
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1211
Rule0: C --> F , C BEFORE F, weight=0.1343
Rule1: Not C --> F , Not C BEFORE F, weight=0.4732
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1795
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0575
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0337
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1365
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4863
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0861
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1136
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3583
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1043
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0770
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2850
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7299
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1310
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0927
Rule16: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0062
Rule17: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0127
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 6.7184 min.
update Log-likelihood (torch)=  -5.190962213506433
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1211,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1343.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4732.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1795.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0575.
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0337.
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1365.
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4863.
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0861.
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.1136.
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3583.
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1043.
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0770.
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.2850.
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.7299.
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1310.
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0927.
Rule16: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0062.
Rule17: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0127.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.0749 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 9 candidate rules.
[multiprocess log-grad] Elapsed: 1.9099 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.00242, std=0.62202, Rule = Not E ^ A ^ C --> F , Not E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00224, std=0.66145, Rule = E ^ A ^ C --> F , E EQUAL F ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00900, std=0.69572, Rule = E ^ A ^ C --> F , E EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00902, std=0.50448, Rule = B ^ A ^ C --> F , B EQUAL C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01369, std=0.49364, Rule = Not B ^ A ^ C --> F , Not B EQUAL A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07213, std=1.20929, Rule = Not D ^ A ^ C --> F , Not D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07485, std=1.25189, Rule = D ^ A ^ C --> F , D BEFORE C ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07953, std=1.26345, Rule = D ^ A ^ C --> F , D BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.10159, std=1.77101, Rule = E ^ A ^ C --> F , E BEFORE A ^ A BEFORE F ^ C BEFORE F
-------------
best gain 0.0024244898845468114 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: D ^ C --> F , D BEFORE F ^ C EQUAL F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.0737 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.6694 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.01612, std=0.67567, Rule = B ^ D ^ C --> F , B BEFORE F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01399, std=0.64261, Rule = B ^ D ^ C --> F , B BEFORE C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01334, std=0.70261, Rule = Not B ^ D ^ C --> F , Not B BEFORE F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01230, std=0.69963, Rule = A ^ D ^ C --> F , A BEFORE F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01175, std=0.27414, Rule = Not B ^ D ^ C --> F , Not B EQUAL C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01079, std=0.69026, Rule = Not A ^ D ^ C --> F , Not A BEFORE F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00999, std=0.35517, Rule = Not B ^ D ^ C --> F , Not B BEFORE D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00967, std=0.66077, Rule = Not B ^ D ^ C --> F , Not B BEFORE C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00819, std=0.32042, Rule = B ^ D ^ C --> F , B EQUAL C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00808, std=0.23212, Rule = Not B ^ D ^ C --> F , Not B EQUAL F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00757, std=0.34887, Rule = Not E ^ D ^ C --> F , Not E BEFORE D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00635, std=0.16911, Rule = E ^ D ^ C --> F , E EQUAL D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00631, std=0.34725, Rule = Not A ^ D ^ C --> F , Not A BEFORE D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00606, std=0.63054, Rule = A ^ D ^ C --> F , A BEFORE C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00606, std=0.29295, Rule = B ^ D ^ C --> F , B EQUAL F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00590, std=0.35957, Rule = B ^ D ^ C --> F , B BEFORE D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00534, std=0.22094, Rule = E ^ D ^ C --> F , E EQUAL F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00520, std=0.24200, Rule = E ^ D ^ C --> F , E EQUAL C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00497, std=0.34764, Rule = A ^ D ^ C --> F , A BEFORE D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00457, std=0.27913, Rule = Not A ^ D ^ C --> F , Not A EQUAL C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00403, std=0.63449, Rule = Not A ^ D ^ C --> F , Not A BEFORE C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00265, std=0.15890, Rule = B ^ D ^ C --> F , B EQUAL D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00094, std=0.38101, Rule = E ^ D ^ C --> F , E BEFORE D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00117, std=0.13851, Rule = Not A ^ D ^ C --> F , Not A EQUAL D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00174, std=0.16319, Rule = Not B ^ D ^ C --> F , Not B EQUAL D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00219, std=0.24597, Rule = Not A ^ D ^ C --> F , Not A EQUAL F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00480, std=0.17460, Rule = A ^ D ^ C --> F , A EQUAL D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00554, std=0.69175, Rule = Not E ^ D ^ C --> F , Not E BEFORE F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00560, std=0.65911, Rule = Not E ^ D ^ C --> F , Not E BEFORE C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00646, std=0.30677, Rule = Not E ^ D ^ C --> F , Not E EQUAL C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00653, std=0.28146, Rule = Not E ^ D ^ C --> F , Not E EQUAL F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00770, std=0.71885, Rule = E ^ D ^ C --> F , E BEFORE C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00784, std=0.73659, Rule = E ^ D ^ C --> F , E BEFORE F ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00784, std=0.16395, Rule = Not E ^ D ^ C --> F , Not E EQUAL D ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00823, std=0.28711, Rule = A ^ D ^ C --> F , A EQUAL C ^ D BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01447, std=0.23220, Rule = A ^ D ^ C --> F , A EQUAL F ^ D BEFORE F ^ C EQUAL F
-------------
best gain 0.016117780648450514 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: D ^ B --> F , D BEFORE B ^ B EQUAL F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.0801 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.6364 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.02287, std=0.72349, Rule = C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01856, std=0.69449, Rule = Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01448, std=0.74510, Rule = Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01365, std=0.81662, Rule = C ^ D ^ B --> F , C BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01188, std=0.35472, Rule = Not C ^ D ^ B --> F , Not C BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01094, std=0.38782, Rule = C ^ D ^ B --> F , C BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00631, std=0.27667, Rule = C ^ D ^ B --> F , C EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00436, std=0.21390, Rule = Not E ^ D ^ B --> F , Not E EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00289, std=0.34517, Rule = Not C ^ D ^ B --> F , Not C EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00274, std=0.18406, Rule = C ^ D ^ B --> F , C EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00211, std=0.17818, Rule = Not A ^ D ^ B --> F , Not A EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00191, std=0.37194, Rule = Not E ^ D ^ B --> F , Not E BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00089, std=0.30498, Rule = A ^ D ^ B --> F , A EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00080, std=0.25815, Rule = Not E ^ D ^ B --> F , Not E EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00013, std=0.37517, Rule = A ^ D ^ B --> F , A EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00118, std=0.16846, Rule = Not C ^ D ^ B --> F , Not C EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00119, std=0.38450, Rule = Not C ^ D ^ B --> F , Not C EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00232, std=0.21948, Rule = A ^ D ^ B --> F , A EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00291, std=0.37680, Rule = C ^ D ^ B --> F , C EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00334, std=0.40638, Rule = E ^ D ^ B --> F , E BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00405, std=0.29912, Rule = E ^ D ^ B --> F , E EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00552, std=0.38302, Rule = Not A ^ D ^ B --> F , Not A BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00592, std=0.30191, Rule = E ^ D ^ B --> F , E EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00725, std=0.24757, Rule = Not A ^ D ^ B --> F , Not A EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00752, std=0.39518, Rule = A ^ D ^ B --> F , A BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00782, std=0.28991, Rule = Not A ^ D ^ B --> F , Not A EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00798, std=0.20541, Rule = Not E ^ D ^ B --> F , Not E EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01004, std=0.76009, Rule = Not A ^ D ^ B --> F , Not A BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01060, std=0.80828, Rule = Not A ^ D ^ B --> F , Not A BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01151, std=0.20505, Rule = E ^ D ^ B --> F , E EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01624, std=0.79774, Rule = A ^ D ^ B --> F , A BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01699, std=0.89721, Rule = A ^ D ^ B --> F , A BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02468, std=0.81805, Rule = Not E ^ D ^ B --> F , Not E BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02546, std=0.85681, Rule = E ^ D ^ B --> F , E BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02733, std=0.89846, Rule = E ^ D ^ B --> F , E BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.02824, std=0.85178, Rule = Not E ^ D ^ B --> F , Not E BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
Best rule is: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F
Best log-likelihood-grad(all-data) = 0.0228742839936986
new rule added.
best gain 0.01855848697284611 does not meet thershold 0.02.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1211
Rule0: C --> F , C BEFORE F, weight=0.1343
Rule1: Not C --> F , Not C BEFORE F, weight=0.4732
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1795
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0575
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0337
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1365
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4863
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0861
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.1136
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3583
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1043
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0770
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2850
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7299
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1310
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0927
Rule16: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0062
Rule17: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0127
Rule18: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1306
Rule0: C --> F , C BEFORE F, weight=0.1282
Rule1: Not C --> F , Not C BEFORE F, weight=0.4602
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1600
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0733
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0206
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0984
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4846
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0738
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.0653
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3743
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1196
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0753
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2504
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7410
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1279
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.1045
Rule16: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=-0.0104
Rule17: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0169
Rule18: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.1031
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 7.3738 min.
Update Log-likelihood (torch)=  -5.178118569622176
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1306,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1282.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4602.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1600.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0733.
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0206.
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0984.
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4846.
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0738.
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.0653.
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3743.
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.1196.
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0753.
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.2504.
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.7410.
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1279.
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1045.
Rule16: B ^ A ^ C --> F , B BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=-0.0104.
Rule17: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0169.
Rule18: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.1031.
delete these rules: [16]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1306
Rule0: C --> F , C BEFORE F, weight=0.1282
Rule1: Not C --> F , Not C BEFORE F, weight=0.4602
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1600
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0733
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0206
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0984
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4846
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0738
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.0653
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3743
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.1196
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0753
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2504
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7410
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1279
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.1045
Rule16: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0169
Rule17: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.1031
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1298
Rule0: C --> F , C BEFORE F, weight=0.1466
Rule1: Not C --> F , Not C BEFORE F, weight=0.4713
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1493
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0623
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0216
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1134
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.5155
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0725
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.0048
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3630
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.0947
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1216
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2120
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7180
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1504
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0826
Rule16: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0062
Rule17: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.1507
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 6.6702 min.
update Log-likelihood (torch)=  -5.133736516225033
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1298,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1466.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4713.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1493.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0623.
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0216.
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1134.
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.5155.
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0725.
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=0.0048.
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3630.
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.0947.
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.1216.
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.2120.
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.7180.
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1504.
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0826.
Rule16: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0062.
Rule17: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.1507.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.0764 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 35 candidate rules.
[multiprocess log-grad] Elapsed: 5.6009 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.04014, std=0.66512, Rule = Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.03931, std=0.70968, Rule = Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.03833, std=0.77404, Rule = C ^ D ^ B --> F , C BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02036, std=0.37619, Rule = C ^ D ^ B --> F , C BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.02017, std=0.34574, Rule = Not C ^ D ^ B --> F , Not C BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01628, std=0.76969, Rule = Not A ^ D ^ B --> F , Not A BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01547, std=0.72335, Rule = Not A ^ D ^ B --> F , Not A BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01324, std=0.84332, Rule = A ^ D ^ B --> F , A BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01236, std=0.36221, Rule = Not E ^ D ^ B --> F , Not E BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01078, std=0.76060, Rule = A ^ D ^ B --> F , A BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00887, std=0.39440, Rule = E ^ D ^ B --> F , E BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00880, std=0.27326, Rule = C ^ D ^ B --> F , C EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00744, std=0.20983, Rule = Not E ^ D ^ B --> F , Not E EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00676, std=0.34947, Rule = A ^ D ^ B --> F , A EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00647, std=0.32091, Rule = Not C ^ D ^ B --> F , Not C EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00564, std=0.35373, Rule = Not C ^ D ^ B --> F , Not C EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00541, std=0.17035, Rule = Not A ^ D ^ B --> F , Not A EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00537, std=0.17821, Rule = C ^ D ^ B --> F , C EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00532, std=0.36629, Rule = Not A ^ D ^ B --> F , Not A BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00525, std=0.25214, Rule = Not E ^ D ^ B --> F , Not E EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00475, std=0.35044, Rule = C ^ D ^ B --> F , C EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00430, std=0.37991, Rule = A ^ D ^ B --> F , A BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00430, std=0.29398, Rule = A ^ D ^ B --> F , A EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00230, std=0.82723, Rule = E ^ D ^ B --> F , E BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00225, std=0.79213, Rule = Not E ^ D ^ B --> F , Not E BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00220, std=0.86812, Rule = E ^ D ^ B --> F , E BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00182, std=0.16110, Rule = Not C ^ D ^ B --> F , Not C EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00145, std=0.21086, Rule = A ^ D ^ B --> F , A EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00006, std=0.82388, Rule = Not E ^ D ^ B --> F , Not E BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00056, std=0.28764, Rule = E ^ D ^ B --> F , E EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00066, std=0.29138, Rule = E ^ D ^ B --> F , E EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00373, std=0.28197, Rule = Not A ^ D ^ B --> F , Not A EQUAL B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00430, std=0.19799, Rule = Not E ^ D ^ B --> F , Not E EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00454, std=0.24062, Rule = Not A ^ D ^ B --> F , Not A EQUAL F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00774, std=0.19710, Rule = E ^ D ^ B --> F , E EQUAL D ^ D BEFORE B ^ B EQUAL F
-------------
Best rule is: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F
Best log-likelihood-grad(all-data) = 0.04014488757365197
new rule added.
Best rule is: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F
Best log-likelihood-grad(all-data) = 0.0393129658294117
new rule added.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1298
Rule0: C --> F , C BEFORE F, weight=0.1466
Rule1: Not C --> F , Not C BEFORE F, weight=0.4713
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1493
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0623
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0216
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1134
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.5155
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0725
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=0.0048
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3630
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.0947
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1216
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.2120
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7180
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1504
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0826
Rule16: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0062
Rule17: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.1507
Rule18: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.0100
Rule19: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1322
Rule0: C --> F , C BEFORE F, weight=0.1385
Rule1: Not C --> F , Not C BEFORE F, weight=0.4817
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1472
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0389
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0353
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1067
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4846
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0790
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight=-0.0077
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3833
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.0919
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1025
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1513
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7036
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1126
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0919
Rule16: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0229
Rule17: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.1836
Rule18: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.0488
Rule19: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight=0.0456
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 7.9718 min.
Update Log-likelihood (torch)=  -5.118159895074607
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1322,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1385.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4817.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1472.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0389.
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0353.
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1067.
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4846.
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0790.
Rule8: B ^ C --> F , B EQUAL F ^ C BEFORE F, weight(torch)=-0.0077.
Rule9: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3833.
Rule10: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.0919.
Rule11: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.1025.
Rule12: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1513.
Rule13: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.7036.
Rule14: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1126.
Rule15: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0919.
Rule16: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0229.
Rule17: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.1836.
Rule18: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.0488.
Rule19: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.0456.
delete these rules: [8]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1322
Rule0: C --> F , C BEFORE F, weight=0.1385
Rule1: Not C --> F , Not C BEFORE F, weight=0.4817
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1472
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0389
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0353
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1067
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4846
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0790
Rule8: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3833
Rule9: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.0919
Rule10: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.1025
Rule11: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1513
Rule12: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7036
Rule13: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1126
Rule14: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0919
Rule15: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0229
Rule16: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.1836
Rule17: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.0488
Rule18: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight=0.0456
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1174
Rule0: C --> F , C BEFORE F, weight=0.1308
Rule1: Not C --> F , Not C BEFORE F, weight=0.4980
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1254
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0381
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0276
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1506
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4711
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0735
Rule8: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3973
Rule9: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.0847
Rule10: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0880
Rule11: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1276
Rule12: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7366
Rule13: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1510
Rule14: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0867
Rule15: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0356
Rule16: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.2297
Rule17: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.0885
Rule18: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight=0.0922
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 7.7573 min.
update Log-likelihood (torch)=  -5.144124754829891
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1174,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1308.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.4980.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1254.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0381.
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0276.
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.1506.
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4711.
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0735.
Rule8: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3973.
Rule9: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.0847.
Rule10: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0880.
Rule11: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1276.
Rule12: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.7366.
Rule13: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1510.
Rule14: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0867.
Rule15: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0356.
Rule16: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.2297.
Rule17: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.0885.
Rule18: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.0922.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.2438 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 8 candidate rules.
[multiprocess log-grad] Elapsed: 1.0753 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.00517, std=0.84331, Rule = C ^ D ^ B --> F , C BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00467, std=0.37437, Rule = Not C ^ D ^ B --> F , Not C BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00280, std=0.41863, Rule = C ^ D ^ B --> F , C BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00048, std=0.38624, Rule = Not E ^ D ^ B --> F , Not E BEFORE D ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00385, std=0.77157, Rule = Not A ^ D ^ B --> F , Not A BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00439, std=0.82980, Rule = Not A ^ D ^ B --> F , Not A BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00628, std=0.90480, Rule = A ^ D ^ B --> F , A BEFORE F ^ D BEFORE B ^ B EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00820, std=0.83003, Rule = A ^ D ^ B --> F , A BEFORE B ^ D BEFORE B ^ B EQUAL F
-------------
best gain 0.005169829858688976 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.2494 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.1315 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.02450, std=0.37830, Rule = Not A ^ Not D ^ Not C --> F , Not A BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01704, std=0.38148, Rule = A ^ Not D ^ Not C --> F , A BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01611, std=0.48282, Rule = E ^ Not D ^ Not C --> F , E BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01459, std=0.28002, Rule = Not A ^ Not D ^ Not C --> F , Not A BEFORE Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01193, std=0.44309, Rule = Not E ^ Not D ^ Not C --> F , Not E BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01193, std=0.44343, Rule = Not B ^ Not D ^ Not C --> F , Not B BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01193, std=0.29227, Rule = Not A ^ Not D ^ Not C --> F , Not A BEFORE Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01093, std=0.31583, Rule = Not B ^ Not D ^ Not C --> F , Not B BEFORE Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.01013, std=0.32693, Rule = Not B ^ Not D ^ Not C --> F , Not B BEFORE Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00842, std=0.29779, Rule = A ^ Not D ^ Not C --> F , A BEFORE Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00762, std=0.33082, Rule = B ^ Not D ^ Not C --> F , B BEFORE Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00682, std=0.14166, Rule = E ^ Not D ^ Not C --> F , E EQUAL Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00675, std=0.30127, Rule = A ^ Not D ^ Not C --> F , A BEFORE Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00621, std=0.42799, Rule = B ^ Not D ^ Not C --> F , B BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00603, std=0.34447, Rule = B ^ Not D ^ Not C --> F , B BEFORE Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00497, std=0.39758, Rule = E ^ Not D ^ Not C --> F , E BEFORE Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00490, std=0.35089, Rule = Not E ^ Not D ^ Not C --> F , Not E BEFORE Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00316, std=0.34839, Rule = Not E ^ Not D ^ Not C --> F , Not E BEFORE Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00224, std=0.37882, Rule = E ^ Not D ^ Not C --> F , E BEFORE Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00167, std=0.12706, Rule = Not A ^ Not D ^ Not C --> F , Not A EQUAL F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00147, std=0.15543, Rule = Not E ^ Not D ^ Not C --> F , Not E EQUAL Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00073, std=0.14814, Rule = Not A ^ Not D ^ Not C --> F , Not A EQUAL Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00036, std=0.15410, Rule = E ^ Not D ^ Not C --> F , E EQUAL F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00029, std=0.14101, Rule = Not A ^ Not D ^ Not C --> F , Not A EQUAL Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00059, std=0.20144, Rule = B ^ Not D ^ Not C --> F , B EQUAL F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00133, std=0.14377, Rule = A ^ Not D ^ Not C --> F , A EQUAL Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00136, std=0.14934, Rule = E ^ Not D ^ Not C --> F , E EQUAL Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00225, std=0.17082, Rule = Not E ^ Not D ^ Not C --> F , Not E EQUAL Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00260, std=0.14551, Rule = Not B ^ Not D ^ Not C --> F , Not B EQUAL F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00276, std=0.13652, Rule = Not E ^ Not D ^ Not C --> F , Not E EQUAL F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00341, std=0.17385, Rule = A ^ Not D ^ Not C --> F , A EQUAL Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00384, std=0.18494, Rule = Not B ^ Not D ^ Not C --> F , Not B EQUAL Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00520, std=0.15928, Rule = B ^ Not D ^ Not C --> F , B EQUAL Not D ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00527, std=0.20962, Rule = Not B ^ Not D ^ Not C --> F , Not B EQUAL Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00580, std=0.16252, Rule = A ^ Not D ^ Not C --> F , A EQUAL F ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00800, std=0.17260, Rule = B ^ Not D ^ Not C --> F , B EQUAL Not C ^ Not D EQUAL Not C ^ Not C BEFORE F
-------------
Best rule is: Not A ^ Not D ^ Not C --> F , Not A BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F
Best log-likelihood-grad(all-data) = 0.024501138404904477
new rule added.
best gain 0.017036850401613783 does not meet thershold 0.02.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1174
Rule0: C --> F , C BEFORE F, weight=0.1308
Rule1: Not C --> F , Not C BEFORE F, weight=0.4980
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1254
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0381
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0276
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.1506
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4711
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0735
Rule8: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3973
Rule9: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.0847
Rule10: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0880
Rule11: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1276
Rule12: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7366
Rule13: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1510
Rule14: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.0867
Rule15: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0356
Rule16: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.2297
Rule17: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.0885
Rule18: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight=0.0922
Rule19: Not A ^ Not D ^ Not C --> F , Not A BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0100
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1230
Rule0: C --> F , C BEFORE F, weight=0.1230
Rule1: Not C --> F , Not C BEFORE F, weight=0.5025
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1285
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0548
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0160
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0941
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4847
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0768
Rule8: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3999
Rule9: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.0742
Rule10: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0937
Rule11: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1310
Rule12: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7162
Rule13: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1504
Rule14: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.1020
Rule15: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0656
Rule16: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.2229
Rule17: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.0802
Rule18: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight=0.0999
Rule19: Not A ^ Not D ^ Not C --> F , Not A BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0318
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 8.3470 min.
Update Log-likelihood (torch)=  -5.175239280255027
Added rule and re-fitted weights. Current rule set is:
Head = F, base(torch) = 0.1230,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1230.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.5025.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1285.
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight(torch)=0.0548.
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight(torch)=0.0160.
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0941.
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.4847.
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight(torch)=0.0768.
Rule8: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.3999.
Rule9: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight(torch)=0.0742.
Rule10: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight(torch)=0.0937.
Rule11: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1310.
Rule12: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.7162.
Rule13: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1504.
Rule14: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1020.
Rule15: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.0656.
Rule16: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.2229.
Rule17: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.0802.
Rule18: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.0999.
Rule19: Not A ^ Not D ^ Not C --> F , Not A BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F, weight(torch)=0.0318.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.3367 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.3596 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.01069, std=0.38915, Rule = Not D ^ A ^ Not C --> F , Not D EQUAL Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00742, std=0.52111, Rule = D ^ A ^ Not C --> F , D EQUAL F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00422, std=0.42842, Rule = D ^ A ^ Not C --> F , D EQUAL Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00392, std=0.62541, Rule = E ^ A ^ Not C --> F , E EQUAL F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00564, std=0.40197, Rule = Not D ^ A ^ Not C --> F , Not D EQUAL A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00566, std=0.58073, Rule = Not E ^ A ^ Not C --> F , Not E EQUAL F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00570, std=0.46047, Rule = Not B ^ A ^ Not C --> F , Not B EQUAL A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00803, std=0.46845, Rule = D ^ A ^ Not C --> F , D EQUAL A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01229, std=0.46242, Rule = B ^ A ^ Not C --> F , B EQUAL A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01274, std=0.79487, Rule = B ^ A ^ Not C --> F , B EQUAL F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01491, std=0.46397, Rule = Not B ^ A ^ Not C --> F , Not B EQUAL Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01791, std=0.47481, Rule = B ^ A ^ Not C --> F , B EQUAL Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01983, std=0.64702, Rule = E ^ A ^ Not C --> F , E EQUAL A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02133, std=0.71379, Rule = Not E ^ A ^ Not C --> F , Not E EQUAL Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02782, std=0.75199, Rule = Not D ^ A ^ Not C --> F , Not D EQUAL F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03094, std=0.72601, Rule = E ^ A ^ Not C --> F , E EQUAL Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03163, std=0.64416, Rule = Not B ^ A ^ Not C --> F , Not B EQUAL F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03196, std=0.81642, Rule = Not E ^ A ^ Not C --> F , Not E EQUAL A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03817, std=1.15271, Rule = Not D ^ A ^ Not C --> F , Not D BEFORE A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04310, std=1.17065, Rule = D ^ A ^ Not C --> F , D BEFORE A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04391, std=1.09707, Rule = Not D ^ A ^ Not C --> F , Not D BEFORE Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.05367, std=1.28114, Rule = B ^ A ^ Not C --> F , B BEFORE Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.05528, std=1.49328, Rule = E ^ A ^ Not C --> F , E BEFORE A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.05635, std=1.18056, Rule = D ^ A ^ Not C --> F , D BEFORE Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06106, std=1.47359, Rule = E ^ A ^ Not C --> F , E BEFORE Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06136, std=1.47592, Rule = Not E ^ A ^ Not C --> F , Not E BEFORE A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06293, std=1.39445, Rule = B ^ A ^ Not C --> F , B BEFORE A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06915, std=1.39598, Rule = Not B ^ A ^ Not C --> F , Not B BEFORE Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07101, std=1.55356, Rule = Not E ^ A ^ Not C --> F , Not E BEFORE Not C ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07436, std=2.34102, Rule = Not B ^ A ^ Not C --> F , Not B BEFORE F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07655, std=1.38807, Rule = Not B ^ A ^ Not C --> F , Not B BEFORE A ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.08891, std=2.85936, Rule = E ^ A ^ Not C --> F , E BEFORE F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.08907, std=2.23755, Rule = D ^ A ^ Not C --> F , D BEFORE F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.09101, std=2.18111, Rule = Not D ^ A ^ Not C --> F , Not D BEFORE F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.09794, std=2.18537, Rule = B ^ A ^ Not C --> F , B BEFORE F ^ A BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.11936, std=3.00013, Rule = Not E ^ A ^ Not C --> F , Not E BEFORE F ^ A BEFORE F ^ Not C BEFORE F
-------------
best gain 0.010692542179445014 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: B ^ C --> F , B BEFORE F ^ C EQUAL F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.3439 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.6017 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.01661, std=0.60138, Rule = Not A ^ B ^ C --> F , Not A BEFORE F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01330, std=0.67639, Rule = D ^ B ^ C --> F , D BEFORE F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01096, std=0.59587, Rule = A ^ B ^ C --> F , A BEFORE F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01007, std=0.28755, Rule = A ^ B ^ C --> F , A BEFORE B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00926, std=0.14130, Rule = Not E ^ B ^ C --> F , Not E EQUAL B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00923, std=0.36117, Rule = E ^ B ^ C --> F , E BEFORE B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00843, std=0.63489, Rule = Not D ^ B ^ C --> F , Not D BEFORE F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00788, std=0.35122, Rule = Not E ^ B ^ C --> F , Not E BEFORE B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00766, std=0.22780, Rule = E ^ B ^ C --> F , E EQUAL F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00745, std=0.63907, Rule = D ^ B ^ C --> F , D BEFORE C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00737, std=0.68295, Rule = Not E ^ B ^ C --> F , Not E BEFORE F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00689, std=0.24421, Rule = E ^ B ^ C --> F , E EQUAL C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00662, std=0.53673, Rule = A ^ B ^ C --> F , A BEFORE C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00645, std=0.26737, Rule = Not A ^ B ^ C --> F , Not A EQUAL C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00608, std=0.32099, Rule = D ^ B ^ C --> F , D BEFORE B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00600, std=0.26798, Rule = Not E ^ B ^ C --> F , Not E EQUAL C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00551, std=0.59708, Rule = Not D ^ B ^ C --> F , Not D BEFORE C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00523, std=0.14091, Rule = Not A ^ B ^ C --> F , Not A EQUAL B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00464, std=0.27875, Rule = Not A ^ B ^ C --> F , Not A BEFORE B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00430, std=0.26954, Rule = Not D ^ B ^ C --> F , Not D EQUAL C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00416, std=0.55531, Rule = Not A ^ B ^ C --> F , Not A BEFORE C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00183, std=0.63908, Rule = Not E ^ B ^ C --> F , Not E BEFORE C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00160, std=0.15346, Rule = E ^ B ^ C --> F , E EQUAL B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00138, std=0.21458, Rule = Not D ^ B ^ C --> F , Not D EQUAL F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00100, std=0.26007, Rule = D ^ B ^ C --> F , D EQUAL C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00047, std=0.15139, Rule = D ^ B ^ C --> F , D EQUAL B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00046, std=0.24589, Rule = Not E ^ B ^ C --> F , Not E EQUAL F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00002, std=0.30175, Rule = Not D ^ B ^ C --> F , Not D BEFORE B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00127, std=0.14773, Rule = Not D ^ B ^ C --> F , Not D EQUAL B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00390, std=0.69882, Rule = E ^ B ^ C --> F , E BEFORE C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00438, std=0.16243, Rule = A ^ B ^ C --> F , A EQUAL B ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00467, std=0.72404, Rule = E ^ B ^ C --> F , E BEFORE F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00485, std=0.23125, Rule = D ^ B ^ C --> F , D EQUAL F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00600, std=0.23948, Rule = Not A ^ B ^ C --> F , Not A EQUAL F ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00789, std=0.25690, Rule = A ^ B ^ C --> F , A EQUAL C ^ B BEFORE F ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01223, std=0.20885, Rule = A ^ B ^ C --> F , A EQUAL F ^ B BEFORE F ^ C EQUAL F
-------------
best gain 0.01660652960162814 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.3455 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.3371 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.00782, std=0.51403, Rule = D ^ Not A ^ C --> F , D EQUAL F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00643, std=0.42040, Rule = B ^ Not A ^ C --> F , B EQUAL C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00229, std=0.72119, Rule = B ^ Not A ^ C --> F , B EQUAL F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00027, std=0.45316, Rule = Not B ^ Not A ^ C --> F , Not B EQUAL C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00024, std=0.52898, Rule = D ^ Not A ^ C --> F , D EQUAL C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00027, std=0.41288, Rule = D ^ Not A ^ C --> F , D EQUAL Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00206, std=0.38533, Rule = Not D ^ Not A ^ C --> F , Not D EQUAL Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00238, std=0.68541, Rule = E ^ Not A ^ C --> F , E EQUAL F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00491, std=0.58391, Rule = E ^ Not A ^ C --> F , E EQUAL C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00557, std=0.58023, Rule = Not E ^ Not A ^ C --> F , Not E EQUAL F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01084, std=0.59960, Rule = Not D ^ Not A ^ C --> F , Not D EQUAL C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01252, std=0.48556, Rule = B ^ Not A ^ C --> F , B EQUAL Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02476, std=0.76886, Rule = E ^ Not A ^ C --> F , E EQUAL Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02887, std=0.81703, Rule = Not E ^ Not A ^ C --> F , Not E EQUAL C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02903, std=0.71212, Rule = Not D ^ Not A ^ C --> F , Not D EQUAL F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02935, std=0.48340, Rule = Not B ^ Not A ^ C --> F , Not B EQUAL Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03018, std=0.63567, Rule = Not B ^ Not A ^ C --> F , Not B EQUAL F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03249, std=1.05110, Rule = Not D ^ Not A ^ C --> F , Not D BEFORE C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03443, std=1.12044, Rule = D ^ Not A ^ C --> F , D BEFORE C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03757, std=0.82073, Rule = Not E ^ Not A ^ C --> F , Not E EQUAL Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.05553, std=1.15998, Rule = D ^ Not A ^ C --> F , D BEFORE Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.05589, std=1.10885, Rule = Not D ^ Not A ^ C --> F , Not D BEFORE Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07160, std=1.41739, Rule = E ^ Not A ^ C --> F , E BEFORE Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07166, std=2.25124, Rule = D ^ Not A ^ C --> F , D BEFORE F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07281, std=1.29280, Rule = B ^ Not A ^ C --> F , B BEFORE Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07701, std=1.48525, Rule = Not E ^ Not A ^ C --> F , Not E BEFORE Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07767, std=2.23340, Rule = Not D ^ Not A ^ C --> F , Not D BEFORE F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07792, std=1.49540, Rule = Not E ^ Not A ^ C --> F , Not E BEFORE C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07806, std=1.26032, Rule = B ^ Not A ^ C --> F , B BEFORE C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07950, std=1.26984, Rule = Not B ^ Not A ^ C --> F , Not B BEFORE Not A ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.08364, std=1.61531, Rule = E ^ Not A ^ C --> F , E BEFORE C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.09116, std=2.23216, Rule = Not B ^ Not A ^ C --> F , Not B BEFORE F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.09518, std=1.36281, Rule = Not B ^ Not A ^ C --> F , Not B BEFORE C ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.11543, std=2.17177, Rule = B ^ Not A ^ C --> F , B BEFORE F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.11847, std=2.92447, Rule = E ^ Not A ^ C --> F , E BEFORE F ^ Not A BEFORE F ^ C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.14148, std=3.03822, Rule = Not E ^ Not A ^ C --> F , Not E BEFORE F ^ Not A BEFORE F ^ C BEFORE F
-------------
best gain 0.007819876450656585 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: D ^ C --> F , D BEFORE C ^ C EQUAL F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.3494 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.5969 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.01283, std=0.61967, Rule = Not A ^ D ^ C --> F , Not A BEFORE F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01245, std=0.64516, Rule = A ^ D ^ C --> F , A BEFORE F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.01042, std=0.25881, Rule = Not B ^ D ^ C --> F , Not B EQUAL C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00920, std=0.26005, Rule = Not A ^ D ^ C --> F , Not A EQUAL C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00745, std=0.63907, Rule = B ^ D ^ C --> F , B BEFORE F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00693, std=0.29960, Rule = B ^ D ^ C --> F , B EQUAL C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00631, std=0.22059, Rule = Not B ^ D ^ C --> F , Not B EQUAL F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00626, std=0.30909, Rule = Not E ^ D ^ C --> F , Not E BEFORE D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00620, std=0.60766, Rule = B ^ D ^ C --> F , B BEFORE C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00592, std=0.15401, Rule = E ^ D ^ C --> F , E EQUAL D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00567, std=0.27881, Rule = B ^ D ^ C --> F , B EQUAL F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00538, std=0.28818, Rule = Not A ^ D ^ C --> F , Not A BEFORE D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00492, std=0.22658, Rule = E ^ D ^ C --> F , E EQUAL C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00491, std=0.66658, Rule = Not B ^ D ^ C --> F , Not B BEFORE F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00488, std=0.57766, Rule = A ^ D ^ C --> F , A BEFORE C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00465, std=0.21210, Rule = E ^ D ^ C --> F , E EQUAL F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00408, std=0.31190, Rule = Not B ^ D ^ C --> F , Not B BEFORE D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00373, std=0.57171, Rule = Not A ^ D ^ C --> F , Not A BEFORE C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00162, std=0.32723, Rule = E ^ D ^ C --> F , E BEFORE D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00117, std=0.11585, Rule = Not A ^ D ^ C --> F , Not A EQUAL D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00109, std=0.29393, Rule = A ^ D ^ C --> F , A BEFORE D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00080, std=0.62832, Rule = Not B ^ D ^ C --> F , Not B BEFORE C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00080, std=0.14175, Rule = B ^ D ^ C --> F , B EQUAL D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00021, std=0.31874, Rule = B ^ D ^ C --> F , B BEFORE D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= 0.00009, std=0.23874, Rule = Not A ^ D ^ C --> F , Not A EQUAL F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00017, std=0.14329, Rule = A ^ D ^ C --> F , A EQUAL D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00388, std=0.27830, Rule = Not E ^ D ^ C --> F , Not E EQUAL C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00429, std=0.26173, Rule = Not E ^ D ^ C --> F , Not E EQUAL F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00432, std=0.14718, Rule = Not B ^ D ^ C --> F , Not B EQUAL D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00473, std=0.26344, Rule = A ^ D ^ C --> F , A EQUAL C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00537, std=0.64826, Rule = Not E ^ D ^ C --> F , Not E BEFORE F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00577, std=0.62195, Rule = Not E ^ D ^ C --> F , Not E BEFORE C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00581, std=0.14613, Rule = Not E ^ D ^ C --> F , Not E EQUAL D ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00677, std=0.69049, Rule = E ^ D ^ C --> F , E BEFORE F ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.00704, std=0.67716, Rule = E ^ D ^ C --> F , E BEFORE C ^ D BEFORE C ^ C EQUAL F
-------------
log-likelihood-grad(all-data) mean= -0.01230, std=0.20820, Rule = A ^ D ^ C --> F , A EQUAL F ^ D BEFORE C ^ C EQUAL F
-------------
best gain 0.012834766487254772 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.3440 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.1473 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.00636, std=0.45089, Rule = Not D ^ Not E ^ Not C --> F , Not D EQUAL Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00394, std=0.59597, Rule = D ^ Not E ^ Not C --> F , D EQUAL F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= 0.00309, std=0.63403, Rule = Not A ^ Not E ^ Not C --> F , Not A EQUAL F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00261, std=0.64598, Rule = A ^ Not E ^ Not C --> F , A EQUAL F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01135, std=1.05034, Rule = Not D ^ Not E ^ Not C --> F , Not D BEFORE Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01255, std=0.44899, Rule = B ^ Not E ^ Not C --> F , B EQUAL Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01290, std=0.52838, Rule = Not B ^ Not E ^ Not C --> F , Not B EQUAL Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01291, std=0.45892, Rule = D ^ Not E ^ Not C --> F , D EQUAL Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02072, std=0.49327, Rule = D ^ Not E ^ Not C --> F , D EQUAL Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02134, std=1.09994, Rule = D ^ Not E ^ Not C --> F , D BEFORE Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02189, std=0.47203, Rule = B ^ Not E ^ Not C --> F , B EQUAL Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02211, std=0.44814, Rule = Not D ^ Not E ^ Not C --> F , Not D EQUAL Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02474, std=1.11773, Rule = A ^ Not E ^ Not C --> F , A BEFORE Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02648, std=0.67557, Rule = Not D ^ Not E ^ Not C --> F , Not D EQUAL F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02789, std=0.80212, Rule = Not A ^ Not E ^ Not C --> F , Not A EQUAL Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02807, std=1.17662, Rule = A ^ Not E ^ Not C --> F , A BEFORE Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02833, std=0.79172, Rule = B ^ Not E ^ Not C --> F , B EQUAL F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03043, std=0.60728, Rule = Not B ^ Not E ^ Not C --> F , Not B EQUAL Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03176, std=0.81685, Rule = A ^ Not E ^ Not C --> F , A EQUAL Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03181, std=0.67852, Rule = Not A ^ Not E ^ Not C --> F , Not A EQUAL Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03516, std=1.11197, Rule = Not A ^ Not E ^ Not C --> F , Not A BEFORE Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03830, std=0.77486, Rule = A ^ Not E ^ Not C --> F , A EQUAL Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04148, std=1.25729, Rule = Not A ^ Not E ^ Not C --> F , Not A BEFORE Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04176, std=1.11861, Rule = Not D ^ Not E ^ Not C --> F , Not D BEFORE Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04332, std=1.16972, Rule = D ^ Not E ^ Not C --> F , D BEFORE Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04919, std=0.74656, Rule = Not B ^ Not E ^ Not C --> F , Not B EQUAL F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.05846, std=2.08957, Rule = Not D ^ Not E ^ Not C --> F , Not D BEFORE F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06337, std=1.35422, Rule = B ^ Not E ^ Not C --> F , B BEFORE Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06428, std=1.43818, Rule = Not B ^ Not E ^ Not C --> F , Not B BEFORE Not C ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06513, std=1.31851, Rule = B ^ Not E ^ Not C --> F , B BEFORE Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06699, std=2.46073, Rule = Not B ^ Not E ^ Not C --> F , Not B BEFORE F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07062, std=2.11565, Rule = D ^ Not E ^ Not C --> F , D BEFORE F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07564, std=1.37913, Rule = Not B ^ Not E ^ Not C --> F , Not B BEFORE Not E ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.11150, std=2.41169, Rule = B ^ Not E ^ Not C --> F , B BEFORE F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.11696, std=2.76579, Rule = Not A ^ Not E ^ Not C --> F , Not A BEFORE F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.11936, std=3.00013, Rule = A ^ Not E ^ Not C --> F , A BEFORE F ^ Not E BEFORE F ^ Not C BEFORE F
-------------
best gain 0.006363617089117774 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
start to extend this rule: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F
----- start add_one_predicate_to_existing_rule -----
---start calculate intensity grad and integral grad.---
[calculate intensity grad and integral grad] Elapsed: 1.3361 min.
---exit calculate intensity grad and integral grad.---
start enumerating candidate rules.
----- start select_and_add_new_rule -----
-------start multiprocess------
cpu num = 48, use 8 workers, process 36 candidate rules.
[multiprocess log-grad] Elapsed: 5.3831 min.
-------end multiprocess------
------Select N best rule-------
log-likelihood-grad(all-data) mean= 0.01648, std=0.59019, Rule = Not A ^ D ^ Not C --> F , Not A EQUAL F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00085, std=0.40871, Rule = B ^ D ^ Not C --> F , B EQUAL D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00130, std=0.41551, Rule = Not B ^ D ^ Not C --> F , Not B EQUAL D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00216, std=0.48159, Rule = Not E ^ D ^ Not C --> F , Not E EQUAL Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00470, std=0.69102, Rule = E ^ D ^ Not C --> F , E EQUAL F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00551, std=0.46714, Rule = B ^ D ^ Not C --> F , B EQUAL Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00586, std=0.43997, Rule = Not A ^ D ^ Not C --> F , Not A EQUAL D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.00604, std=0.81558, Rule = B ^ D ^ Not C --> F , B EQUAL F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01064, std=0.49501, Rule = Not B ^ D ^ Not C --> F , Not B EQUAL Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01286, std=0.54768, Rule = Not A ^ D ^ Not C --> F , Not A EQUAL Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01546, std=0.50225, Rule = E ^ D ^ Not C --> F , E EQUAL Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01743, std=0.69435, Rule = A ^ D ^ Not C --> F , A EQUAL F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01743, std=0.64170, Rule = Not E ^ D ^ Not C --> F , Not E EQUAL F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.01848, std=0.46405, Rule = E ^ D ^ Not C --> F , E EQUAL D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02206, std=0.66071, Rule = Not B ^ D ^ Not C --> F , Not B EQUAL F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02219, std=0.99216, Rule = Not E ^ D ^ Not C --> F , Not E BEFORE D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02424, std=1.07153, Rule = Not A ^ D ^ Not C --> F , Not A BEFORE D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02465, std=0.53355, Rule = A ^ D ^ Not C --> F , A EQUAL Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02646, std=0.50182, Rule = A ^ D ^ Not C --> F , A EQUAL D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.02909, std=1.07354, Rule = A ^ D ^ Not C --> F , A BEFORE D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03003, std=1.01881, Rule = E ^ D ^ Not C --> F , E BEFORE D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03025, std=1.09209, Rule = Not B ^ D ^ Not C --> F , Not B BEFORE D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03272, std=1.07330, Rule = Not A ^ D ^ Not C --> F , Not A BEFORE Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03295, std=2.15141, Rule = Not B ^ D ^ Not C --> F , Not B BEFORE F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03456, std=0.47793, Rule = Not E ^ D ^ Not C --> F , Not E EQUAL D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03707, std=1.11323, Rule = A ^ D ^ Not C --> F , A BEFORE Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.03836, std=1.11085, Rule = B ^ D ^ Not C --> F , B BEFORE D ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04009, std=1.14339, Rule = Not B ^ D ^ Not C --> F , Not B BEFORE Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04555, std=1.19344, Rule = B ^ D ^ Not C --> F , B BEFORE Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04738, std=1.14643, Rule = E ^ D ^ Not C --> F , E BEFORE Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.04974, std=2.09207, Rule = B ^ D ^ Not C --> F , B BEFORE F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.06117, std=1.11692, Rule = Not E ^ D ^ Not C --> F , Not E BEFORE Not C ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07062, std=2.11565, Rule = Not E ^ D ^ Not C --> F , Not E BEFORE F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07359, std=2.13890, Rule = E ^ D ^ Not C --> F , E BEFORE F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.07612, std=2.16469, Rule = Not A ^ D ^ Not C --> F , Not A BEFORE F ^ D BEFORE F ^ Not C BEFORE F
-------------
log-likelihood-grad(all-data) mean= -0.08907, std=2.23755, Rule = A ^ D ^ Not C --> F , A BEFORE F ^ D BEFORE F ^ Not C BEFORE F
-------------
best gain 0.01648248629653639 does not meet thershold 0.02.
----- exit select_and_add_new_rule -----
----- exit add_one_predicate_to_existing_rule -----
Train finished, rule set is:
Head = F, base = 0.1230
Rule0: C --> F , C BEFORE F, weight=0.1230
Rule1: Not C --> F , Not C BEFORE F, weight=0.5025
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1285
Rule3: Not E ^ Not C --> F , Not E BEFORE F ^ Not C BEFORE F, weight=0.0548
Rule4: D ^ Not C --> F , D BEFORE F ^ Not C BEFORE F, weight=0.0160
Rule5: Not D ^ Not C --> F , Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0941
Rule6: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4847
Rule7: Not A ^ C --> F , Not A BEFORE F ^ C BEFORE F, weight=0.0768
Rule8: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3999
Rule9: D ^ C --> F , D BEFORE C ^ C EQUAL F, weight=0.0742
Rule10: B ^ C --> F , B BEFORE F ^ C EQUAL F, weight=0.0937
Rule11: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1310
Rule12: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7162
Rule13: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1504
Rule14: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.1020
Rule15: B ^ A ^ C --> F , B BEFORE A ^ A BEFORE F ^ C BEFORE F, weight=0.0656
Rule16: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.2229
Rule17: Not C ^ D ^ B --> F , Not C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.0802
Rule18: Not C ^ D ^ B --> F , Not C BEFORE F ^ D BEFORE B ^ B EQUAL F, weight=0.0999
Rule19: Not A ^ Not D ^ Not C --> F , Not A BEFORE F ^ Not D EQUAL Not C ^ Not C BEFORE F, weight=0.0318
delete these rules: [3, 4, 5, 7, 9, 10, 15, 17, 18, 19]
start re-fit weights
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1230
Rule0: C --> F , C BEFORE F, weight=0.1230
Rule1: Not C --> F , Not C BEFORE F, weight=0.5025
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1285
Rule3: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4847
Rule4: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.3999
Rule5: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1310
Rule6: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7162
Rule7: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1504
Rule8: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.1020
Rule9: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.2229
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1129
Rule0: C --> F , C BEFORE F, weight=0.1494
Rule1: Not C --> F , Not C BEFORE F, weight=0.5836
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1570
Rule3: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.5144
Rule4: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.5190
Rule5: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1318
Rule6: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7280
Rule7: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1485
Rule8: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.1202
Rule9: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.2879
---- exit optimize_log_likelihood multi-process----
[optimize log-likelihood] Elapsed: 4.2514 min.
update Log-likelihood (torch)=  -5.185377437453393
Deleted some rules and refited weights, Current rule set is:
Head = F, base(torch) = 0.1129,
Rule0: C --> F , C BEFORE F, weight(torch)=0.1494.
Rule1: Not C --> F , Not C BEFORE F, weight(torch)=0.5836.
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight(torch)=0.1570.
Rule3: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight(torch)=0.5144.
Rule4: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight(torch)=0.5190.
Rule5: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight(torch)=0.1318.
Rule6: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.7280.
Rule7: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1485.
Rule8: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight(torch)=0.1202.
Rule9: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight(torch)=0.2879.
---- start optimize_log_likelihood multi-process----
Rule set is:
Head = F, base = 0.1129
Rule0: C --> F , C BEFORE F, weight=0.1494
Rule1: Not C --> F , Not C BEFORE F, weight=0.5836
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1570
Rule3: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.5144
Rule4: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.5190
Rule5: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1318
Rule6: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7280
Rule7: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1485
Rule8: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.1202
Rule9: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.2879
use 8 workers for 75 batches
optimized rule weights are:
Head = F, base = 0.1366
Rule0: C --> F , C BEFORE F, weight=0.1255
Rule1: Not C --> F , Not C BEFORE F, weight=0.6094
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1343
Rule3: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4954
Rule4: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.5252
Rule5: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1368
Rule6: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7567
Rule7: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1501
Rule8: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.1520
Rule9: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.3122
---- exit optimize_log_likelihood multi-process----
Train finished, rule set is:
Head = F, base = 0.1366
Rule0: C --> F , C BEFORE F, weight=0.1255
Rule1: Not C --> F , Not C BEFORE F, weight=0.6094
Rule2: A ^ Not C --> F , A BEFORE F ^ Not C BEFORE F, weight=0.1343
Rule3: A ^ C --> F , A BEFORE F ^ C BEFORE F, weight=0.4954
Rule4: D ^ C --> F , D BEFORE F ^ C EQUAL F, weight=0.5252
Rule5: D ^ B --> F , D BEFORE B ^ B EQUAL F, weight=0.1368
Rule6: B ^ A ^ C --> F , B EQUAL F ^ A BEFORE F ^ C BEFORE F, weight=0.7567
Rule7: Not B ^ A ^ C --> F , Not B EQUAL C ^ A BEFORE F ^ C BEFORE F, weight=0.1501
Rule8: Not E ^ A ^ C --> F , Not E BEFORE F ^ A BEFORE F ^ C BEFORE F, weight=0.1520
Rule9: C ^ D ^ B --> F , C BEFORE B ^ D BEFORE B ^ B EQUAL F, weight=0.3122
----- exit search_algorithm -----
[search_algorithm] Elapsed: 5.2102 hour.
Finish time is 2021-03-04 15:15:39.237172
